<!DOCTYPE html>
<html lang="vi">
<head>
Â  <!-- ======================================================
Â  Â  Â  Â MEDIA â€¢ AI ENGLISH LEARNING SYSTEM
Â  Â  Â  Â CORE HTML SKELETON
Â  Â  Â  Â Author: Tráº§n Quá»‘c Trung
Â  Â  Â  Â Version: 1.0
Â  Â  Â  Â ====================================================== -->
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <!-- SEO META -->
Â  <meta name="description" content="Media Player + AI English Learning Platform">
Â  <meta name="keywords" content="English Learning, Music, Lyrics, AI, Quiz">
Â  <meta name="author" content="Tráº§n Quá»‘c Trung">
Â  <title>Media â€¢ AI English Learning</title>
Â  <!-- ======================================================
Â  Â  Â  Â GLOBAL STYLE IMPORT
Â  Â  Â  Â ====================================================== -->
Â  <style>
Â  Â  /* ===========================
Â  Â  Â  Â GLOBAL RESET
Â  Â  Â  Â =========================== */
Â  Â  * {
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  Â  box-sizing: border-box;
Â  Â  }

Â  Â  html, body {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  font-family: "Times New Roman", serif;
Â  Â  Â  background: #0b0f16;
Â  Â  Â  color: #ffffff;
Â  Â  Â  line-height: 1.6;
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â ROOT VARIABLES
Â  Â  Â  Â =========================== */
Â  Â  :root {
Â  Â  Â  --primary: #ff3b3b;
Â  Â  Â  --secondary: #1e90ff;
Â  Â  Â  --bg-dark: #0b0f16;
Â  Â  Â  --bg-card: rgba(255,255,255,0.06);
Â  Â  Â  --border-soft: rgba(255,255,255,0.15);
Â  Â  Â  --radius: 16px;
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â LAYOUT CONTAINER
Â  Â  Â  Â =========================== */
Â  Â  .app-container {
Â  Â  Â  max-width: 1400px;
Â  Â  Â  margin: auto;
Â  Â  Â  padding: 24px;
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â HEADER
Â  Â  Â  Â =========================== */
Â  Â  header {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  Â  margin-bottom: 24px;
Â  Â  }
Â  Â  header h1 {
Â  Â  Â  font-size: 28px;
Â  Â  Â  font-weight: bold;
Â  Â  Â  color: var(--primary);
Â  Â  }
Â  Â  header .subtitle {
Â  Â  Â  font-size: 14px;
Â  Â  Â  opacity: 0.85;
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â GRID SYSTEM
Â  Â  Â  Â =========================== */
Â  Â  .grid {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: 1.2fr 0.8fr;
Â  Â  Â  gap: 20px;
Â  Â  }
Â  Â  @media (max-width: 900px) {
Â  Â  Â  .grid {
Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  }
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â CARD COMPONENT
Â  Â  Â  Â =========================== */
Â  Â  .card {
Â  Â  Â  background: var(--bg-card);
Â  Â  Â  border: 1px solid var(--border-soft);
Â  Â  Â  border-radius: var(--radius);
Â  Â  Â  padding: 16px;
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â  .card-title {
Â  Â  Â  font-size: 18px;
Â  Â  Â  font-weight: bold;
Â  Â  Â  margin-bottom: 12px;
Â  Â  Â  color: #ffd166;
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â MEDIA PLAYER CONTAINER
Â  Â  Â  Â =========================== */
Â  Â  .player-wrapper iframe {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 340px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  background: #000;
Â  Â  }
Â  Â  /* ===========================
Â  Â  Â  Â BUTTON SYSTEM
Â  Â  Â  Â =========================== */
Â  Â  button {
Â  Â  Â  padding: 10px 14px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  border: 1px solid var(--border-soft);
Â  Â  Â  background: rgba(255,255,255,0.08);
Â  Â  Â  color: #fff;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-weight: bold;
Â  Â  Â  transition: 0.2s;
Â  Â  }
Â  Â  button:hover {
Â  Â  Â  background: rgba(255,255,255,0.18);
Â  Â  }
Â  </style>
</head>
<body>
Â  <!-- ======================================================
Â  Â  Â  Â APPLICATION ROOT
Â  Â  Â  Â ====================================================== -->
Â  <div class="app-container">
Â  Â  <!-- ================= HEADER ================= -->
Â  Â  <header>
Â  Â  Â  <div>
Â  Â  Â  Â  <h1>ğŸ§ Media â€¢ AI English Learning</h1>
Â  Â  Â  Â  <div class="subtitle">
Â  Â  Â  Â  Â  Learn English through Music, Lyrics & AI
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </header>
Â  Â  <!-- ================= MAIN GRID ================= -->
Â  Â  <div class="grid">
Â  Â  Â  <!-- LEFT COLUMN -->
Â  Â  Â  <div>
Â  Â  Â  Â  <!-- MEDIA PLAYER -->
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  <div class="card-title">ğŸµ Media Player</div>
Â  Â  Â  Â  Â  <div class="player-wrapper">
Â  Â  Â  Â  Â  Â  <iframe id="ytPlayer"
Â  Â  Â  Â  Â  Â  Â  src=""
Â  Â  Â  Â  Â  Â  Â  allow="autoplay; encrypted-media"
Â  Â  Â  Â  Â  Â  Â  allowfullscreen>
Â  Â  Â  Â  Â  Â  </iframe>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <!-- LYRICS -->
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  <div class="card-title">ğŸ“ Lyrics (Bilingual)</div>
Â  Â  Â  Â  Â  <textarea id="lyricsBox"
Â  Â  Â  Â  Â  Â  style="width:100%;height:180px;
Â  Â  Â  Â  Â  Â  background:#111;color:#fff;
Â  Â  Â  Â  Â  Â  border-radius:12px;padding:12px;">
Â  Â  Â  Â  Â  </textarea>
Â  Â  Â  Â  Â  <div style="margin-top:10px;display:flex;gap:10px;">
Â  Â  Â  Â  Â  Â  <button id="saveLyric">ğŸ’¾ Save</button>
Â  Â  Â  Â  Â  Â  <button id="clearLyric">ğŸ§¹ Clear</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <!-- RIGHT COLUMN -->
Â  Â  Â  <div>
Â  Â  Â  Â  <!-- PLAYLIST -->
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  <div class="card-title">ğŸ¶ Playlist</div>
Â  Â  Â  Â  Â  <div id="playlist"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</body>
</html>
/* =========================================================
Â  Â PART 2 â€” CSS ENGINE PRO
Â  Â Media â€¢ AI English Learning â€¢ Portfolio (Single-file)
Â  Â Author: Tráº§n Quá»‘c Trung
Â  Â ========================================================= */
/* =========================
Â  Â 0) RESET + BASE
Â  Â ========================= */
*{ margin:0; padding:0; box-sizing:border-box; }
html{ scroll-behavior:smooth; }
body{
Â  min-height:100vh;
Â  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
Â  background: radial-gradient(900px 500px at 15% 10%, rgba(255,59,59,.18), transparent 55%),
Â  Â  Â  Â  Â  Â  Â  radial-gradient(900px 500px at 80% 20%, rgba(255,213,74,.14), transparent 60%),
Â  Â  Â  Â  Â  Â  Â  radial-gradient(700px 500px at 40% 85%, rgba(74,144,255,.10), transparent 55%),
Â  Â  Â  Â  Â  Â  Â  linear-gradient(180deg, #05070c 0%, #070A10 100%);
Â  color: rgba(255,255,255,.92);
Â  overflow-x:hidden;
}
img{ max-width:100%; display:block; }
a{ color:inherit; text-decoration:none; }
button, input, select, textarea{ font-family:inherit; }
/* =========================
Â  Â 1) THEME VARIABLES
Â  Â ========================= */
:root{
Â  --bg:#070A10;
Â  --bg2:#05070c;
Â  --txt:rgba(255,255,255,.92);
Â  --muted:rgba(255,255,255,.68);
Â  --muted2:rgba(255,255,255,.56);
Â  --panel:rgba(255,255,255,.06);
Â  --panel2:rgba(255,255,255,.08);
Â  --line:rgba(255,255,255,.12);
Â  --brand:#ff3b3b;
Â  --brand2:#ffd54a;
Â  --blue:#6aa6ff;
Â  --radius:18px;
Â  --radius2:24px;
Â  --shadow:0 18px 60px rgba(0,0,0,.55);
Â  --ring:0 0 0 4px rgba(255,59,59,.12);
Â  --glass: blur(12px);
Â  --max:1160px;
Â  /* text sizes */
Â  --t-xs:12px;
Â  --t-sm:13px;
Â  --t-md:14px;
Â  --t-lg:16px;
Â  --t-xl:18px;
Â  --t-xxl:24px;
Â  /* spacing */
Â  --s-1:6px;
Â  --s-2:10px;
Â  --s-3:14px;
Â  --s-4:18px;
Â  --s-5:24px;
Â  --s-6:32px;
Â  /* transitions */
Â  --ease:.18s ease;
}
/* LIGHT THEME (optional toggle) */
[data-theme="light"]{
Â  --bg:#f6f7fb;
Â  --bg2:#ffffff;
Â  --txt:rgba(0,0,0,.88);
Â  --muted:rgba(0,0,0,.64);
Â  --muted2:rgba(0,0,0,.52);
Â  --panel:rgba(0,0,0,.04);
Â  --panel2:rgba(0,0,0,.06);
Â  --line:rgba(0,0,0,.10);
Â  --shadow:0 18px 60px rgba(0,0,0,.14);
Â  --ring:0 0 0 4px rgba(255,59,59,.18);
}
/* =========================
Â  Â 2) LAYOUT UTILITIES
Â  Â ========================= */
.wrap{ max-width:var(--max); margin:0 auto; padding:0 18px; }
.grid{ display:grid; gap:16px; }
.flex{ display:flex; gap:10px; }
.center{ display:grid; place-items:center; }
.hidden{ display:none !important; }
.muted{ color:var(--muted); }
.muted2{ color:var(--muted2); }
.bold{ font-weight:900; }
.card{
Â  background: linear-gradient(180deg, var(--panel) 0%, rgba(255,255,255,.04) 100%);
Â  border:1px solid var(--line);
Â  border-radius:var(--radius);
Â  box-shadow:var(--shadow);
Â  backdrop-filter:var(--glass);
}
.pad{ padding:18px; }
/* =========================
Â  Â 3) HEADER / NAV
Â  Â ========================= */
header{
Â  position:sticky;
Â  top:0;
Â  z-index:50;
Â  background: rgba(7,10,16,.62);
Â  border-bottom:1px solid rgba(255,255,255,.08);
Â  backdrop-filter: blur(10px);
}
[data-theme="light"] header{
Â  background: rgba(255,255,255,.75);
Â  border-bottom:1px solid rgba(0,0,0,.08);
}
.nav{
Â  display:flex;
Â  align-items:center;
Â  justify-content:space-between;
Â  padding:10px 0;
Â  gap:12px;
}
.brandWrap{ display:flex; align-items:center; gap:10px; }
.brandBadge{
Â  width:36px; height:36px;
Â  border-radius:14px;
Â  display:grid; place-items:center;
Â  background:linear-gradient(135deg, rgba(255,59,59,.22), rgba(255,213,74,.18));
Â  border:1px solid rgba(255,255,255,.14);
Â  box-shadow:0 14px 40px rgba(0,0,0,.18);
Â  flex:0 0 auto;
}
.brandBadge span{
Â  font-weight:900;
Â  background:linear-gradient(135deg, var(--brand), var(--brand2));
Â  -webkit-background-clip:text;
Â  background-clip:text;
Â  color:transparent;
Â  letter-spacing:.4px;
}
.brandTitle{ font-weight:900; font-size:14px; line-height:1.15; }
.brandSub{ font-weight:800; font-size:12px; color:var(--muted2); }
.navLinks{
Â  display:flex;
Â  align-items:center;
Â  gap:6px;
Â  flex-wrap:wrap;
Â  justify-content:flex-end;
}
.navLinks a{
Â  color:var(--muted);
Â  font-weight:800;
Â  font-size:12.5px;
Â  padding:9px 10px;
Â  border-radius:12px;
Â  border:1px solid transparent;
Â  transition:var(--ease);
}
.navLinks a:hover{
Â  color:var(--txt);
Â  border-color:rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.05);
}
.navLinks a.active{
Â  color:var(--txt);
Â  border-color:rgba(255,59,59,.22);
Â  background:linear-gradient(135deg, rgba(255,59,59,.16), rgba(255,213,74,.10));
}
.actions{ display:flex; align-items:center; gap:8px; }
.iconBtn{
Â  display:inline-flex; align-items:center; justify-content:center;
Â  width:40px; height:40px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  cursor:pointer;
Â  transition:var(--ease);
Â  user-select:none;
}
.iconBtn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.06); }
.iconBtn:focus{ outline:none; box-shadow:var(--ring); }
.kbd{ font-weight:900; font-size:12px; opacity:.9; }
/* =========================
Â  Â 4) HERO / TITLES / TEXT
Â  Â ========================= */
.hero{ padding:20px 0 10px; }
.heroGrid{ grid-template-columns: 1.12fr .88fr; align-items:stretch; }
.headline{
Â  font-size:42px;
Â  line-height:1.06;
Â  margin:10px 0 12px;
Â  letter-spacing:-.8px;
}
.grad{
Â  background:linear-gradient(135deg,var(--brand),var(--brand2));
Â  -webkit-background-clip:text;
Â  background-clip:text;
Â  color:transparent;
}
.sub{
Â  font-size:15px;
Â  line-height:1.7;
Â  color:var(--muted);
Â  margin:0 0 14px;
Â  max-width:70ch;
Â  white-space:pre-line;
}
.titleRow{
Â  display:flex;
Â  align-items:flex-end;
Â  justify-content:space-between;
Â  gap:12px;
Â  margin:4px 0 12px;
}
.titleRow h2{
Â  margin:0;
Â  font-size:18px;
Â  letter-spacing:-.2px;
}

/* =========================
Â  Â 5) BADGES / PILLS / CHIPS
Â  Â ========================= */
.pill{
Â  display:inline-flex; align-items:center; gap:8px;
Â  padding:8px 12px;
Â  border-radius:999px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--muted);
Â  font-weight:800;
Â  font-size:13px;
Â  white-space:nowrap;
}
.dot{
Â  width:8px; height:8px;
Â  border-radius:999px;
Â  background:linear-gradient(135deg, var(--brand), var(--brand2));
Â  box-shadow: 0 0 0 4px rgba(255,59,59,.12);
}
.badge{
Â  font-size:11px;
Â  font-weight:900;
Â  padding:7px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.14);
Â  background:rgba(255,255,255,.04);
Â  color:var(--muted);
Â  white-space:nowrap;
}
.badge.red{ border-color: rgba(255,59,59,.25); }
.badge.yellow{ border-color: rgba(255,213,74,.25); }
.badge.blue{ border-color: rgba(106,166,255,.25); }

.chip{
Â  display:inline-flex; align-items:center; gap:8px;
Â  padding:7px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.04);
Â  font-weight:900;
Â  font-size:11px;
Â  color:var(--muted2);
}
/* =========================
Â  Â 6) BUTTONS / INPUTS
Â  Â ========================= */
.btn{
Â  display:inline-flex;
Â  align-items:center;
Â  justify-content:center;
Â  gap:10px;
Â  padding:12px 14px;
Â  border-radius:14px;
Â  border:1px solid rgba(255,255,255,.14);
Â  background:rgba(255,255,255,.05);
Â  color:var(--txt);
Â  font-weight:900;
Â  font-size:14px;
Â  min-width:190px;
Â  cursor:pointer;
Â  transition:var(--ease);
Â  user-select:none;
}
[data-theme="light"] .btn{ border-color: rgba(0,0,0,.12); }
.btn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.07); }
.btn:focus{ outline:none; box-shadow:var(--ring); }
.btnPrimary{
Â  border-color: rgba(255,59,59,.35);
Â  background:linear-gradient(135deg, rgba(255,59,59,.25), rgba(255,213,74,.14));
}
.btnPrimary:hover{
Â  background:linear-gradient(135deg, rgba(255,59,59,.32), rgba(255,213,74,.18));
}
.btn .ico{
Â  width:28px; height:28px;
Â  border-radius:12px;
Â  display:grid; place-items:center;
Â  background:rgba(255,255,255,.07);
Â  border:1px solid rgba(255,255,255,.12);
}
.btn small{
Â  display:block;
Â  margin-top:2px;
Â  font-size:11px;
Â  color:var(--muted);
Â  font-weight:800;
}

/* Smaller action buttons (Media section) */
.miniBtn{
Â  display:inline-flex;
Â  align-items:center;
Â  justify-content:center;
Â  gap:8px;
Â  padding:10px 12px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  cursor:pointer;
Â  font-weight:900;
Â  font-size:12.5px;
Â  transition:var(--ease);
}
.miniBtn:hover{ background:rgba(255,255,255,.06); }
.miniBtn:focus{ outline:none; box-shadow:var(--ring); }
.input, .select, .textarea{
Â  padding:11px 12px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--txt);
Â  font-weight:800;
Â  font-size:13px;
Â  outline:none;
}
.select{ min-width:180px; }
.textarea{ min-height:120px; resize:vertical; }
/* =========================
Â  Â 7) LIST / ITEMS / PANELS
Â  Â ========================= */
.list{ display:grid; gap:12px; }
.item{
Â  padding:14px;
Â  border-radius:16px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
}
.item h3{ margin:0 0 6px; font-size:14px; }
.item p{ margin:0; color:var(--muted); font-size:13px; line-height:1.6; }
.tagRow{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
/* =========================
Â  Â 8) MODAL / OVERLAY
Â  Â ========================= */
.overlay{
Â  position:fixed; inset:0;
Â  background:rgba(0,0,0,.55);
Â  display:none;
Â  align-items:center;
Â  justify-content:center;
Â  padding:18px;
Â  z-index:99;
}
.overlay.show{ display:flex; }
.modal{
Â  width:min(920px, 100%);
Â  border-radius:22px;
Â  border:1px solid var(--line);
Â  background:linear-gradient(180deg, var(--panel2), var(--panel));
Â  box-shadow: 0 30px 120px rgba(0,0,0,.6);
Â  overflow:hidden;
}
.modalHead{
Â  padding:14px 14px;
Â  display:flex;
Â  justify-content:space-between;
Â  gap:10px;
Â  align-items:center;
Â  border-bottom:1px solid rgba(255,255,255,.10);
}
.modalHead b{ font-weight:900; }
.modalBody{ padding:14px; }
.closeBtn{
Â  width:42px; height:42px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  cursor:pointer;
Â  font-weight:900;
Â  transition:var(--ease);
}
.closeBtn:hover{ background:rgba(255,255,255,.06); }
/* =========================
Â  Â 9) TOAST / NOTIFY
Â  Â ========================= */
.toast{
Â  position:fixed;
Â  right:16px;
Â  bottom:16px;
Â  padding:12px 14px;
Â  border-radius:16px;
Â  border:1px solid var(--line);
Â  background:rgba(0,0,0,.65);
Â  color:rgba(255,255,255,.92);
Â  font-weight:900;
Â  display:none;
Â  z-index:120;
Â  backdrop-filter: blur(10px);
Â  max-width: 320px;
}
[data-theme="light"] .toast{
Â  background:rgba(255,255,255,.85);
Â  color:rgba(0,0,0,.88);
}
.toast.show{ display:block; }
.topBtn{
Â  position:fixed;
Â  left:16px;
Â  bottom:16px;
Â  width:46px; height:46px;
Â  border-radius:18px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.05);
Â  display:none;
Â  place-items:center;
Â  cursor:pointer;
Â  z-index:120;
Â  font-weight:900;
Â  backdrop-filter: blur(10px);
}
.topBtn.show{ display:grid; }
.topBtn:hover{ background:rgba(255,255,255,.08); }
/* =========================
Â  Â 10) MEDIA SECTION PRO UI
Â  Â ========================= */
.mediaGrid{ grid-template-columns: 1.05fr .95fr; }

.playerBox{
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.03);
Â  overflow:hidden;
}
.playerBox iframe{
Â  width:100%;
Â  height:420px;
Â  border:0;
Â  display:block;
Â  background:#000;
}
.miniBtns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
.playlistWrap{ display:grid; gap:10px; }
.playlistTools{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  align-items:center;
}
.playlistTools .input{ min-width:240px; flex:1; }
.playlistScroll{
Â  max-height:520px;
Â  overflow:auto;
Â  padding-right:6px;
Â  scroll-behavior:smooth;
}
.playlistScroll::-webkit-scrollbar{ width:10px; }
.playlistScroll::-webkit-scrollbar-thumb{
Â  background: rgba(255,255,255,.14);
Â  border-radius: 999px;
Â  border: 1px solid rgba(255,255,255,.12);
}
[data-theme="light"] .playlistScroll::-webkit-scrollbar-thumb{
Â  background: rgba(0,0,0,.12);
}
.playlist{ display:grid; gap:10px; }
.track{
Â  border:1px solid var(--line);
Â  border-radius:16px;
Â  background:rgba(255,255,255,.04);
Â  padding:12px;
Â  cursor:pointer;
Â  transition:var(--ease);
Â  display:grid;
Â  gap:6px;
}
.track:hover{ transform:translateY(-1px); background:rgba(255,255,255,.06); }
.track.active{
Â  border-color: rgba(255,59,59,.35);
Â  background:linear-gradient(135deg, rgba(255,59,59,.18), rgba(255,213,74,.10));
}
.trackTop{ display:flex; justify-content:space-between; gap:10px; align-items:center; }
.trackTitle{ font-weight:900; font-size:13px; }
.trackMeta{ color:var(--muted2); font-weight:900; font-size:11px; letter-spacing:.6px; text-transform:uppercase; }
.trackDesc{ color:var(--muted); font-size:12.5px; line-height:1.55; margin:0; }
/* Lyrics box */
.lyricBox{
Â  margin-top:12px;
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.03);
Â  overflow:hidden;
}
.lyricHead{
Â  padding:12px 14px;
Â  display:flex;
Â  justify-content:space-between;
Â  align-items:center;
Â  gap:10px;
Â  border-bottom:1px solid rgba(255,255,255,.10);
}
.lyricHead b{ font-weight:900; font-size:13px; }
.lyricHint{ color:var(--muted2); font-weight:800; font-size:12px; white-space:nowrap; }
.lyricBody{ padding:12px 14px; }
.lyricText{
Â  width:100%;
Â  min-height:160px;
Â  resize:vertical;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--txt);
Â  font-weight:800;
Â  font-size:13px;
Â  outline:none;
Â  line-height:1.6;
Â  padding:12px;
}
.lyricActions{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  margin-top:10px;
}
/* =========================
Â  Â 11) AI TRANSLATE PANEL UI
Â  Â ========================= */
.aiGrid{
Â  display:grid;
Â  grid-template-columns: 1fr 1fr;
Â  gap:12px;
}
@media (max-width: 900px){ .aiGrid{ grid-template-columns:1fr; } }

.aiBox{
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.04);
Â  padding:14px;
}
.aiBoxHead{
Â  display:flex;
Â  justify-content:space-between;
Â  align-items:center;
Â  gap:10px;
Â  margin-bottom:10px;
}
.aiBoxHead b{ font-weight:900; font-size:13px; }
.aiMode{
Â  font-size:11px;
Â  font-weight:900;
Â  padding:7px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.14);
Â  background:rgba(255,255,255,.04);
Â  color:var(--muted);
}
.aiTextarea{
Â  width:100%;
Â  min-height:140px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--txt);
Â  font-weight:800;
Â  font-size:13px;
Â  outline:none;
Â  line-height:1.6;
Â  padding:12px;
Â  resize:vertical;
}
.aiActions{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  margin-top:10px;
}
/* =========================
Â  Â 12) VOCAB TRACKER UI
Â  Â ========================= */
.vocabRow{
Â  display:grid;
Â  grid-template-columns: 1fr 1fr 120px;
Â  gap:10px;
}
@media (max-width: 680px){
Â  .vocabRow{ grid-template-columns:1fr; }
}
.vocabTable{
Â  margin-top:12px;
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  overflow:hidden;
}
.vocabTable .vHead, .vocabTable .vItem{
Â  display:grid;
Â  grid-template-columns: 1.2fr 1.2fr .8fr .8fr 110px;
Â  gap:10px;
Â  padding:12px 14px;
}
.vocabTable .vHead{
Â  background:rgba(255,255,255,.06);
Â  font-weight:900;
Â  font-size:12px;
Â  color:var(--muted2);
Â  text-transform:uppercase;
Â  letter-spacing:.6px;
}
.vocabTable .vItem{
Â  background:rgba(255,255,255,.03);
Â  border-top:1px dashed rgba(255,255,255,.10);
Â  font-weight:800;
Â  font-size:13px;
}
.vocabTag{
Â  display:inline-flex;
Â  align-items:center;
Â  justify-content:center;
Â  padding:6px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.04);
Â  font-weight:900;
Â  font-size:11px;
Â  color:var(--muted);
}
/* =========================
Â  Â 13) QUIZ ENGINE UI
Â  Â ========================= */
.quizWrap{
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.03);
Â  overflow:hidden;
}
.quizHead{
Â  padding:12px 14px;
Â  display:flex;
Â  justify-content:space-between;
Â  align-items:center;
Â  gap:10px;
Â  border-bottom:1px solid rgba(255,255,255,.10);
}
.quizHead b{ font-weight:900; font-size:13px; }
.quizScore{
Â  font-weight:900;
Â  font-size:12px;
Â  color:var(--muted2);
}
.quizBody{ padding:14px; display:grid; gap:12px; }
.qCard{
Â  border:1px solid var(--line);
Â  border-radius:16px;
Â  background:rgba(255,255,255,.04);
Â  padding:14px;
}
.qTitle{ font-weight:900; font-size:14px; margin-bottom:10px; }
.qOptions{ display:grid; gap:10px; }
.qOpt{
Â  border:1px solid rgba(255,255,255,.14);
Â  border-radius:14px;
Â  background:rgba(255,255,255,.03);
Â  padding:10px 12px;
Â  cursor:pointer;
Â  font-weight:900;
Â  font-size:13px;
Â  transition:var(--ease);
}
.qOpt:hover{ background:rgba(255,255,255,.06); transform:translateY(-1px); }
.qOpt.correct{
Â  border-color: rgba(74,200,120,.45);
Â  background: rgba(74,200,120,.12);
}
.qOpt.wrong{
Â  border-color: rgba(255,59,59,.45);
Â  background: rgba(255,59,59,.12);
}
.quizFooter{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  margin-top:6px;
}
/* =========================
Â  Â 14) RESPONSIVE TWEAKS
Â  Â ========================= */
@media (max-width: 1040px){
Â  .heroGrid{ grid-template-columns:1fr; }
Â  .mediaGrid{ grid-template-columns:1fr; }
Â  .playerBox iframe{ height:320px; }
Â  .playlistScroll{ max-height:420px; }
}
@media (max-width: 560px){
Â  .headline{ font-size:32px; }
Â  .actions{ display:none; }
Â  .playerBox iframe{ height:240px; }
Â  .playlistScroll{ max-height:320px; }
Â  .lyricText{ min-height:140px; }
}
/* =========================================================
Â  Â END PART 2 â€” CSS ENGINE PRO
Â  Â ========================================================= */
/* =========================================================
Â  Â PART 2 â€” CSS ENGINE PRO
Â  Â Media â€¢ AI English Learning â€¢ Portfolio (Single-file)
Â  Â Author: Tráº§n Quá»‘c Trung
Â  Â ========================================================= */
/* =========================
Â  Â 0) RESET + BASE
Â  Â ========================= */
*{ margin:0; padding:0; box-sizing:border-box; }
html{ scroll-behavior:smooth; }
body{
Â  min-height:100vh;
Â  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
Â  background: radial-gradient(900px 500px at 15% 10%, rgba(255,59,59,.18), transparent 55%),
Â  Â  Â  Â  Â  Â  Â  radial-gradient(900px 500px at 80% 20%, rgba(255,213,74,.14), transparent 60%),
Â  Â  Â  Â  Â  Â  Â  radial-gradient(700px 500px at 40% 85%, rgba(74,144,255,.10), transparent 55%),
Â  Â  Â  Â  Â  Â  Â  linear-gradient(180deg, #05070c 0%, #070A10 100%);
Â  color: rgba(255,255,255,.92);
Â  overflow-x:hidden;
}
img{ max-width:100%; display:block; }
a{ color:inherit; text-decoration:none; }
button, input, select, textarea{ font-family:inherit; }
/* =========================
Â  Â 1) THEME VARIABLES
Â  Â ========================= */
:root{
Â  --bg:#070A10;
Â  --bg2:#05070c;
Â  --txt:rgba(255,255,255,.92);
Â  --muted:rgba(255,255,255,.68);
Â  --muted2:rgba(255,255,255,.56);
Â  --panel:rgba(255,255,255,.06);
Â  --panel2:rgba(255,255,255,.08);
Â  --line:rgba(255,255,255,.12);
Â  --brand:#ff3b3b;
Â  --brand2:#ffd54a;
Â  --blue:#6aa6ff;
Â  --radius:18px;
Â  --radius2:24px;
Â  --shadow:0 18px 60px rgba(0,0,0,.55);
Â  --ring:0 0 0 4px rgba(255,59,59,.12);
Â  --glass: blur(12px);
Â  --max:1160px;
Â  /* text sizes */
Â  --t-xs:12px;
Â  --t-sm:13px;
Â  --t-md:14px;
Â  --t-lg:16px;
Â  --t-xl:18px;
Â  --t-xxl:24px;
Â  /* spacing */
Â  --s-1:6px;
Â  --s-2:10px;
Â  --s-3:14px;
Â  --s-4:18px;
Â  --s-5:24px;
Â  --s-6:32px;
Â  /* transitions */
Â  --ease:.18s ease;
}
/* LIGHT THEME (optional toggle) */
[data-theme="light"]{
Â  --bg:#f6f7fb;
Â  --bg2:#ffffff;
Â  --txt:rgba(0,0,0,.88);
Â  --muted:rgba(0,0,0,.64);
Â  --muted2:rgba(0,0,0,.52);
Â  --panel:rgba(0,0,0,.04);
Â  --panel2:rgba(0,0,0,.06);
Â  --line:rgba(0,0,0,.10);
Â  --shadow:0 18px 60px rgba(0,0,0,.14);
Â  --ring:0 0 0 4px rgba(255,59,59,.18);
}
/* =========================
Â  Â 2) LAYOUT UTILITIES
Â  Â ========================= */
.wrap{ max-width:var(--max); margin:0 auto; padding:0 18px; }
.grid{ display:grid; gap:16px; }
.flex{ display:flex; gap:10px; }
.center{ display:grid; place-items:center; }
.hidden{ display:none !important; }
.muted{ color:var(--muted); }
.muted2{ color:var(--muted2); }
.bold{ font-weight:900; }
.card{
Â  background: linear-gradient(180deg, var(--panel) 0%, rgba(255,255,255,.04) 100%);
Â  border:1px solid var(--line);
Â  border-radius:var(--radius);
Â  box-shadow:var(--shadow);
Â  backdrop-filter:var(--glass);
}
.pad{ padding:18px; }
/* =========================
Â  Â 3) HEADER / NAV
Â  Â ========================= */
header{
Â  position:sticky;
Â  top:0;
Â  z-index:50;
Â  background: rgba(7,10,16,.62);
Â  border-bottom:1px solid rgba(255,255,255,.08);
Â  backdrop-filter: blur(10px);
}
[data-theme="light"] header{
Â  background: rgba(255,255,255,.75);
Â  border-bottom:1px solid rgba(0,0,0,.08);
}
.nav{
Â  display:flex;
Â  align-items:center;
Â  justify-content:space-between;
Â  padding:10px 0;
Â  gap:12px;
}
.brandWrap{ display:flex; align-items:center; gap:10px; }
.brandBadge{
Â  width:36px; height:36px;
Â  border-radius:14px;
Â  display:grid; place-items:center;
Â  background:linear-gradient(135deg, rgba(255,59,59,.22), rgba(255,213,74,.18));
Â  border:1px solid rgba(255,255,255,.14);
Â  box-shadow:0 14px 40px rgba(0,0,0,.18);
Â  flex:0 0 auto;
}
.brandBadge span{
Â  font-weight:900;
Â  background:linear-gradient(135deg, var(--brand), var(--brand2));
Â  -webkit-background-clip:text;
Â  background-clip:text;
Â  color:transparent;
Â  letter-spacing:.4px;
}
.brandTitle{ font-weight:900; font-size:14px; line-height:1.15; }
.brandSub{ font-weight:800; font-size:12px; color:var(--muted2); }
.navLinks{
Â  display:flex;
Â  align-items:center;
Â  gap:6px;
Â  flex-wrap:wrap;
Â  justify-content:flex-end;
}
.navLinks a{
Â  color:var(--muted);
Â  font-weight:800;
Â  font-size:12.5px;
Â  padding:9px 10px;
Â  border-radius:12px;
Â  border:1px solid transparent;
Â  transition:var(--ease);
}
.navLinks a:hover{
Â  color:var(--txt);
Â  border-color:rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.05);
}
.navLinks a.active{
Â  color:var(--txt);
Â  border-color:rgba(255,59,59,.22);
Â  background:linear-gradient(135deg, rgba(255,59,59,.16), rgba(255,213,74,.10));
}

.actions{ display:flex; align-items:center; gap:8px; }
.iconBtn{
Â  display:inline-flex; align-items:center; justify-content:center;
Â  width:40px; height:40px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  cursor:pointer;
Â  transition:var(--ease);
Â  user-select:none;
}
.iconBtn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.06); }
.iconBtn:focus{ outline:none; box-shadow:var(--ring); }
.kbd{ font-weight:900; font-size:12px; opacity:.9; }
/* =========================
Â  Â 4) HERO / TITLES / TEXT
Â  Â ========================= */
.hero{ padding:20px 0 10px; }
.heroGrid{ grid-template-columns: 1.12fr .88fr; align-items:stretch; }
.headline{
Â  font-size:42px;
Â  line-height:1.06;
Â  margin:10px 0 12px;
Â  letter-spacing:-.8px;
}
.grad{
Â  background:linear-gradient(135deg,var(--brand),var(--brand2));
Â  -webkit-background-clip:text;
Â  background-clip:text;
Â  color:transparent;
}
.sub{
Â  font-size:15px;
Â  line-height:1.7;
Â  color:var(--muted);
Â  margin:0 0 14px;
Â  max-width:70ch;
Â  white-space:pre-line;
}
.titleRow{
Â  display:flex;
Â  align-items:flex-end;
Â  justify-content:space-between;
Â  gap:12px;
Â  margin:4px 0 12px;
}
.titleRow h2{
Â  margin:0;
Â  font-size:18px;
Â  letter-spacing:-.2px;
}
/* =========================
Â  Â 5) BADGES / PILLS / CHIPS
Â  Â ========================= */
.pill{
Â  display:inline-flex; align-items:center; gap:8px;
Â  padding:8px 12px;
Â  border-radius:999px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--muted);
Â  font-weight:800;
Â  font-size:13px;
Â  white-space:nowrap;
}
.dot{
Â  width:8px; height:8px;
Â  border-radius:999px;
Â  background:linear-gradient(135deg, var(--brand), var(--brand2));
Â  box-shadow: 0 0 0 4px rgba(255,59,59,.12);
}
.badge{
Â  font-size:11px;
Â  font-weight:900;
Â  padding:7px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.14);
Â  background:rgba(255,255,255,.04);
Â  color:var(--muted);
Â  white-space:nowrap;
}
.badge.red{ border-color: rgba(255,59,59,.25); }
.badge.yellow{ border-color: rgba(255,213,74,.25); }
.badge.blue{ border-color: rgba(106,166,255,.25); }
.chip{
Â  display:inline-flex; align-items:center; gap:8px;
Â  padding:7px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.04);
Â  font-weight:900;
Â  font-size:11px;
Â  color:var(--muted2);
}
/* =========================
Â  Â 6) BUTTONS / INPUTS
Â  Â ========================= */
.btn{
Â  display:inline-flex;
Â  align-items:center;
Â  justify-content:center;
Â  gap:10px;
Â  padding:12px 14px;
Â  border-radius:14px;
Â  border:1px solid rgba(255,255,255,.14);
Â  background:rgba(255,255,255,.05);
Â  color:var(--txt);
Â  font-weight:900;
Â  font-size:14px;
Â  min-width:190px;
Â  cursor:pointer;
Â  transition:var(--ease);
Â  user-select:none;
}
[data-theme="light"] .btn{ border-color: rgba(0,0,0,.12); }
.btn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.07); }
.btn:focus{ outline:none; box-shadow:var(--ring); }
.btnPrimary{
Â  border-color: rgba(255,59,59,.35);
Â  background:linear-gradient(135deg, rgba(255,59,59,.25), rgba(255,213,74,.14));
}
.btnPrimary:hover{
Â  background:linear-gradient(135deg, rgba(255,59,59,.32), rgba(255,213,74,.18));
}
.btn .ico{
Â  width:28px; height:28px;
Â  border-radius:12px;
Â  display:grid; place-items:center;
Â  background:rgba(255,255,255,.07);
Â  border:1px solid rgba(255,255,255,.12);
}
.btn small{
Â  display:block;
Â  margin-top:2px;
Â  font-size:11px;
Â  color:var(--muted);
Â  font-weight:800;
}
/* Smaller action buttons (Media section) */
.miniBtn{
Â  display:inline-flex;
Â  align-items:center;
Â  justify-content:center;
Â  gap:8px;
Â  padding:10px 12px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  cursor:pointer;
Â  font-weight:900;
Â  font-size:12.5px;
Â  transition:var(--ease);
}
.miniBtn:hover{ background:rgba(255,255,255,.06); }
.miniBtn:focus{ outline:none; box-shadow:var(--ring); }
.input, .select, .textarea{
Â  padding:11px 12px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--txt);
Â  font-weight:800;
Â  font-size:13px;
Â  outline:none;
}
.select{ min-width:180px; }
.textarea{ min-height:120px; resize:vertical; }
/* =========================
Â  Â 7) LIST / ITEMS / PANELS
Â  Â ========================= */
.list{ display:grid; gap:12px; }
.item{
Â  padding:14px;
Â  border-radius:16px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
}
.item h3{ margin:0 0 6px; font-size:14px; }
.item p{ margin:0; color:var(--muted); font-size:13px; line-height:1.6; }
.tagRow{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
/* =========================
Â  Â 8) MODAL / OVERLAY
Â  Â ========================= */
.overlay{
Â  position:fixed; inset:0;
Â  background:rgba(0,0,0,.55);
Â  display:none;
Â  align-items:center;
Â  justify-content:center;
Â  padding:18px;
Â  z-index:99;
}
.overlay.show{ display:flex; }
.modal{
Â  width:min(920px, 100%);
Â  border-radius:22px;
Â  border:1px solid var(--line);
Â  background:linear-gradient(180deg, var(--panel2), var(--panel));
Â  box-shadow: 0 30px 120px rgba(0,0,0,.6);
Â  overflow:hidden;
}
.modalHead{
Â  padding:14px 14px;
Â  display:flex;
Â  justify-content:space-between;
Â  gap:10px;
Â  align-items:center;
Â  border-bottom:1px solid rgba(255,255,255,.10);
}
.modalHead b{ font-weight:900; }
.modalBody{ padding:14px; }
.closeBtn{
Â  width:42px; height:42px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  cursor:pointer;
Â  font-weight:900;
Â  transition:var(--ease);
}
.closeBtn:hover{ background:rgba(255,255,255,.06); }
/* =========================
Â  Â 9) TOAST / NOTIFY
Â  Â ========================= */
.toast{
Â  position:fixed;
Â  right:16px;
Â  bottom:16px;
Â  padding:12px 14px;
Â  border-radius:16px;
Â  border:1px solid var(--line);
Â  background:rgba(0,0,0,.65);
Â  color:rgba(255,255,255,.92);
Â  font-weight:900;
Â  display:none;
Â  z-index:120;
Â  backdrop-filter: blur(10px);
Â  max-width: 320px;
}
[data-theme="light"] .toast{
Â  background:rgba(255,255,255,.85);
Â  color:rgba(0,0,0,.88);
}
.toast.show{ display:block; }
.topBtn{
Â  position:fixed;
Â  left:16px;
Â  bottom:16px;
Â  width:46px; height:46px;
Â  border-radius:18px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.05);
Â  display:none;
Â  place-items:center;
Â  cursor:pointer;
Â  z-index:120;
Â  font-weight:900;
Â  backdrop-filter: blur(10px);
}
.topBtn.show{ display:grid; }
.topBtn:hover{ background:rgba(255,255,255,.08); }
/* =========================
Â  Â 10) MEDIA SECTION PRO UI
Â  Â ========================= */
.mediaGrid{ grid-template-columns: 1.05fr .95fr; }
.playerBox{
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.03);
Â  overflow:hidden;
}
.playerBox iframe{
Â  width:100%;
Â  height:420px;
Â  border:0;
Â  display:block;
Â  background:#000;
}
.miniBtns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
.playlistWrap{ display:grid; gap:10px; }
.playlistTools{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  align-items:center;
}
.playlistTools .input{ min-width:240px; flex:1; }
.playlistScroll{
Â  max-height:520px;
Â  overflow:auto;
Â  padding-right:6px;
Â  scroll-behavior:smooth;
}
.playlistScroll::-webkit-scrollbar{ width:10px; }
.playlistScroll::-webkit-scrollbar-thumb{
Â  background: rgba(255,255,255,.14);
Â  border-radius: 999px;
Â  border: 1px solid rgba(255,255,255,.12);
}
[data-theme="light"] .playlistScroll::-webkit-scrollbar-thumb{
Â  background: rgba(0,0,0,.12);
}
.playlist{ display:grid; gap:10px; }
.track{
Â  border:1px solid var(--line);
Â  border-radius:16px;
Â  background:rgba(255,255,255,.04);
Â  padding:12px;
Â  cursor:pointer;
Â  transition:var(--ease);
Â  display:grid;
Â  gap:6px;
}
.track:hover{ transform:translateY(-1px); background:rgba(255,255,255,.06); }
.track.active{
Â  border-color: rgba(255,59,59,.35);
Â  background:linear-gradient(135deg, rgba(255,59,59,.18), rgba(255,213,74,.10));
}
.trackTop{ display:flex; justify-content:space-between; gap:10px; align-items:center; }
.trackTitle{ font-weight:900; font-size:13px; }
.trackMeta{ color:var(--muted2); font-weight:900; font-size:11px; letter-spacing:.6px; text-transform:uppercase; }
.trackDesc{ color:var(--muted); font-size:12.5px; line-height:1.55; margin:0; }
/* Lyrics box */
.lyricBox{
Â  margin-top:12px;
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.03);
Â  overflow:hidden;
}
.lyricHead{
Â  padding:12px 14px;
Â  display:flex;
Â  justify-content:space-between;
Â  align-items:center;
Â  gap:10px;
Â  border-bottom:1px solid rgba(255,255,255,.10);
}
.lyricHead b{ font-weight:900; font-size:13px; }
.lyricHint{ color:var(--muted2); font-weight:800; font-size:12px; white-space:nowrap; }
.lyricBody{ padding:12px 14px; }
.lyricText{
Â  width:100%;
Â  min-height:160px;
Â  resize:vertical;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--txt);
Â  font-weight:800;
Â  font-size:13px;
Â  outline:none;
Â  line-height:1.6;
Â  padding:12px;
}
.lyricActions{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  margin-top:10px;
}
/* =========================
Â  Â 11) AI TRANSLATE PANEL UI
Â  Â ========================= */
.aiGrid{
Â  display:grid;
Â  grid-template-columns: 1fr 1fr;
Â  gap:12px;
}
@media (max-width: 900px){ .aiGrid{ grid-template-columns:1fr; } }
.aiBox{
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.04);
Â  padding:14px;
}
.aiBoxHead{
Â  display:flex;
Â  justify-content:space-between;
Â  align-items:center;
Â  gap:10px;
Â  margin-bottom:10px;
}
.aiBoxHead b{ font-weight:900; font-size:13px; }
.aiMode{
Â  font-size:11px;
Â  font-weight:900;
Â  padding:7px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.14);
Â  background:rgba(255,255,255,.04);
Â  color:var(--muted);
}
.aiTextarea{
Â  width:100%;
Â  min-height:140px;
Â  border-radius:14px;
Â  border:1px solid var(--line);
Â  background:rgba(255,255,255,.04);
Â  color:var(--txt);
Â  font-weight:800;
Â  font-size:13px;
Â  outline:none;
Â  line-height:1.6;
Â  padding:12px;
Â  resize:vertical;
}
.aiActions{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  margin-top:10px;
}
/* =========================
Â  Â 12) VOCAB TRACKER UI
Â  Â ========================= */
.vocabRow{
Â  display:grid;
Â  grid-template-columns: 1fr 1fr 120px;
Â  gap:10px;
}
@media (max-width: 680px){
Â  .vocabRow{ grid-template-columns:1fr; }
}
.vocabTable{
Â  margin-top:12px;
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  overflow:hidden;
}
.vocabTable .vHead, .vocabTable .vItem{
Â  display:grid;
Â  grid-template-columns: 1.2fr 1.2fr .8fr .8fr 110px;
Â  gap:10px;
Â  padding:12px 14px;
}
.vocabTable .vHead{
Â  background:rgba(255,255,255,.06);
Â  font-weight:900;
Â  font-size:12px;
Â  color:var(--muted2);
Â  text-transform:uppercase;
Â  letter-spacing:.6px;
}
.vocabTable .vItem{
Â  background:rgba(255,255,255,.03);
Â  border-top:1px dashed rgba(255,255,255,.10);
Â  font-weight:800;
Â  font-size:13px;
}
.vocabTag{
Â  display:inline-flex;
Â  align-items:center;
Â  justify-content:center;
Â  padding:6px 10px;
Â  border-radius:999px;
Â  border:1px solid rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.04);
Â  font-weight:900;
Â  font-size:11px;
Â  color:var(--muted);
}
/* =========================
Â  Â 13) QUIZ ENGINE UI
Â  Â ========================= */
.quizWrap{
Â  border:1px solid var(--line);
Â  border-radius:18px;
Â  background:rgba(255,255,255,.03);
Â  overflow:hidden;
}
.quizHead{
Â  padding:12px 14px;
Â  display:flex;
Â  justify-content:space-between;
Â  align-items:center;
Â  gap:10px;
Â  border-bottom:1px solid rgba(255,255,255,.10);
}
.quizHead b{ font-weight:900; font-size:13px; }
.quizScore{
Â  font-weight:900;
Â  font-size:12px;
Â  color:var(--muted2);
}
.quizBody{ padding:14px; display:grid; gap:12px; }
.qCard{
Â  border:1px solid var(--line);
Â  border-radius:16px;
Â  background:rgba(255,255,255,.04);
Â  padding:14px;
}
.qTitle{ font-weight:900; font-size:14px; margin-bottom:10px; }
.qOptions{ display:grid; gap:10px; }
.qOpt{
Â  border:1px solid rgba(255,255,255,.14);
Â  border-radius:14px;
Â  background:rgba(255,255,255,.03);
Â  padding:10px 12px;
Â  cursor:pointer;
Â  font-weight:900;
Â  font-size:13px;
Â  transition:var(--ease);
}
.qOpt:hover{ background:rgba(255,255,255,.06); transform:translateY(-1px); }
.qOpt.correct{
Â  border-color: rgba(74,200,120,.45);
Â  background: rgba(74,200,120,.12);
}
.qOpt.wrong{
Â  border-color: rgba(255,59,59,.45);
Â  background: rgba(255,59,59,.12);
}
.quizFooter{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  margin-top:6px;
}
/* =========================
Â  Â 14) RESPONSIVE TWEAKS
Â  Â ========================= */
@media (max-width: 1040px){
Â  .heroGrid{ grid-template-columns:1fr; }
Â  .mediaGrid{ grid-template-columns:1fr; }
Â  .playerBox iframe{ height:320px; }
Â  .playlistScroll{ max-height:420px; }
}
@media (max-width: 560px){
Â  .headline{ font-size:32px; }
Â  .actions{ display:none; }
Â  .playerBox iframe{ height:240px; }
Â  .playlistScroll{ max-height:320px; }
Â  .lyricText{ min-height:140px; }
}
/* =========================================================
Â  Â END PART 2 â€” CSS ENGINE PRO
Â  Â ========================================================= */
/* =========================================================
Â  Â PART 3 â€” MEDIA PLAYER CORE JS (YouTube)
Â  Â âœ… No duplicate listeners
Â  Â âœ… Playlist click -> play
Â  Â âœ… Search/filter
Â  Â âœ… Next/Prev/Shuffle/Repeat
Â  Â âœ… Save last playing + time
Â  Â âœ… Lyrics: save per-song (EN/VI) into localStorage
Â  Â ========================================================= */
/* =========================
Â  Â 0) HELPERS
Â  Â ========================= */
const $Â  = (q, root=document) => root.querySelector(q);
const $$ = (q, root=document) => Array.from(root.querySelectorAll(q));
function toast(msg){
Â  const el = $("#toast");
Â  if(!el) return alert(msg);
Â  el.textContent = msg;
Â  el.classList.add("show");
Â  clearTimeout(toast._t);
Â  toast._t = setTimeout(()=> el.classList.remove("show"), 1800);
}
function safeJSONParse(str, fallback){
Â  try{ return JSON.parse(str); }catch(e){ return fallback; }
}
function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }
function norm(str){
Â  return (str||"")
Â  Â  .toString()
Â  Â  .trim()
Â  Â  .toLowerCase()
Â  Â  .normalize("NFD")
Â  Â  .replace(/[\u0300-\u036f]/g,""); // remove accents
}
/* =========================
Â  Â 1) DOM ELEMENTS (MUST MATCH HTML IDs)
Â  Â ========================= */
const ytPlayerÂ  Â  Â = $("#ytPlayer");Â  Â  Â  Â  // <iframe id="ytPlayer">
const playlistElÂ  Â = $("#playlist");Â  Â  Â  Â  // <div id="playlist">
const searchElÂ  Â  Â = $("#trackSearch");Â  Â  Â // <input id="trackSearch">
const nowTitleElÂ  Â = $("#nowTitle");Â  Â  Â  Â  // <b id="nowTitle">
const nowMetaElÂ  Â  = $("#nowMeta");Â  Â  Â  Â  Â // <span id="nowMeta">
const nowTypeElÂ  Â  = $("#nowType");Â  Â  Â  Â  Â // <span id="nowType">
const btnPrevÂ  Â  Â  = $("#btnPrev");
const btnNextÂ  Â  Â  = $("#btnNext");
const btnShuffleÂ  Â = $("#btnShuffle");
const btnRepeatÂ  Â  = $("#btnRepeat");
const btnCopyLinkÂ  = $("#btnCopyLink");
const btnSaveTimeÂ  = $("#btnSaveTime");Â  Â  Â // optional
const btnResetTime = $("#btnResetTime");Â  Â  // optional
// Lyrics
const lyricEnElÂ  Â  = $("#lyricEN");Â  Â  Â  Â  Â // <textarea id="lyricEN">
const lyricViElÂ  Â  = $("#lyricVI");Â  Â  Â  Â  Â // <textarea id="lyricVI">
const btnSaveLyric = $("#btnSaveLyric");
const btnLoadLyric = $("#btnLoadLyric");
const btnClearLyric= $("#btnClearLyric");
/* =========================
Â  Â 2) DATA: PLAYLIST
Â  Â - You only need: id, title
Â  Â - Optional: artist, tag, note, start (seconds)
Â  Â ========================= */
// âœ… 100 bÃ i cá»±c ná»•i tiáº¿ng (mix US/UK + global + Kpop + Latin + EDM)
// LÆ°u Ã½: view thay Ä‘á»•i theo thá»i gian. Danh sÃ¡ch nÃ y Æ°u tiÃªn cÃ¡c video ráº¥t phá»• biáº¿n.
const MEDIA = [
Â  { type:"MUSIC", title:"Despacito â€” Luis Fonsi ft. Daddy Yankee", meta:"GLOBAL", desc:"Official video", videoId:"kJQP7kiw5Fk" },
Â  { type:"MUSIC", title:"See You Again â€” Wiz Khalifa ft. Charlie Puth", meta:"US/UK", desc:"Official video", videoId:"RgKAFK5djSk" },
Â  { type:"MUSIC", title:"Shape of You â€” Ed Sheeran", meta:"US/UK", desc:"Official video", videoId:"JGwWNGJdvx8" },
Â  { type:"MUSIC", title:"Uptown Funk â€” Mark Ronson ft. Bruno Mars", meta:"US/UK", desc:"Official video", videoId:"OPf0YbXqDm0" },
Â  { type:"MUSIC", title:"Gangnam Style â€” PSY", meta:"K-POP", desc:"Official video", videoId:"9bZkp7q19f0" },
Â  { type:"MUSIC", title:"Sorry â€” Justin Bieber", meta:"US/UK", desc:"Official video", videoId:"fRh_vgS2dFE" },
Â  { type:"MUSIC", title:"Sugar â€” Maroon 5", meta:"US/UK", desc:"Official video", videoId:"09R8_2nJtjg" },
Â  { type:"MUSIC", title:"Roar â€” Katy Perry", meta:"US/UK", desc:"Official video", videoId:"CevxZvSJLk8" },
Â  { type:"MUSIC", title:"Thinking Out Loud â€” Ed Sheeran", meta:"US/UK", desc:"Official video", videoId:"lp-EO5I60KA" },
Â  { type:"MUSIC", title:"Counting Stars â€” OneRepublic", meta:"US/UK", desc:"Official video", videoId:"hT_nvWreIhg" },
Â  { type:"MUSIC", title:"Dark Horse â€” Katy Perry", meta:"US/UK", desc:"Official video", videoId:"0KSOMA3QBU0" },
Â  { type:"MUSIC", title:"Faded â€” Alan Walker", meta:"EDM", desc:"Official video", videoId:"60ItHLz5WEA" },
Â  { type:"MUSIC", title:"Believer â€” Imagine Dragons", meta:"US/UK", desc:"Official video", videoId:"7wtfhZwyrcc" },
Â  { type:"MUSIC", title:"Lean On â€” Major Lazer & DJ Snake", meta:"EDM", desc:"Official video", videoId:"YqeW9_5kURI" },
Â  { type:"MUSIC", title:"Perfect â€” Ed Sheeran", meta:"US/UK", desc:"Official video", videoId:"2Vv-BfVoq4g" },
Â  { type:"MUSIC", title:"Havana â€” Camila Cabello", meta:"US/UK", desc:"Official video", videoId:"HCjNJDNzw8Y" },
Â  { type:"MUSIC", title:"bad guy â€” Billie Eilish", meta:"US/UK", desc:"Official video", videoId:"DyDfgMOUjCI" },
Â  { type:"MUSIC", title:"Closer â€” The Chainsmokers ft. Halsey", meta:"US/UK", desc:"Official video", videoId:"0zGcUoRlhmw" },
Â  { type:"MUSIC", title:"Girls Like You â€” Maroon 5 ft. Cardi B", meta:"US/UK", desc:"Official video", videoId:"aJOTlE1K90k" },
Â  { type:"MUSIC", title:"Cheap Thrills â€” Sia", meta:"US/UK", desc:"Official video", videoId:"nYh-n7EOtMA" },
Â  { type:"MUSIC", title:"Hello â€” Adele", meta:"US/UK", desc:"Official video", videoId:"YQHsXMglC9A" },
Â  { type:"MUSIC", title:"All About That Bass â€” Meghan Trainor", meta:"US/UK", desc:"Official video", videoId:"7PCkvCPvDXk" },
Â  { type:"MUSIC", title:"Waka Waka â€” Shakira", meta:"GLOBAL", desc:"Official video", videoId:"pRpeEdMmmQ0" },
Â  { type:"MUSIC", title:"Chandelier â€” Sia", meta:"US/UK", desc:"Official video", videoId:"2vjPBrBU-TM" },
Â  { type:"MUSIC", title:"Love The Way You Lie â€” Eminem ft. Rihanna", meta:"US/UK", desc:"Official video", videoId:"uelHwf8o7_U" },
Â  { type:"MUSIC", title:"Let Her Go â€” Passenger", meta:"US/UK", desc:"Official video", videoId:"RBumgq5yVrA" },
Â  { type:"MUSIC", title:"Blank Space â€” Taylor Swift", meta:"US/UK", desc:"Official video", videoId:"e-ORhEE9VVg" },
Â  { type:"MUSIC", title:"Thunder â€” Imagine Dragons", meta:"US/UK", desc:"Official video", videoId:"fKopy74weus" },
Â  { type:"MUSIC", title:"On The Floor â€” Jennifer Lopez ft. Pitbull", meta:"GLOBAL", desc:"Official video", videoId:"t4H_Zoh7G5A" },
Â  { type:"MUSIC", title:"Dame Tu Cosita â€” El Chombo", meta:"GLOBAL", desc:"Official video", videoId:"FzG4uDgje3M" },
Â  // --- thÃªm 70 bÃ i ná»¯a (Ä‘á»ƒ Ä‘á»§ 100) ---
Â  { type:"MUSIC", title:"Sorry â€” (Lyric Video) Justin Bieber", meta:"US/UK", desc:"Alt video", videoId:"_Tzj7PZqk2I" },
Â  { type:"MUSIC", title:"Counting Stars â€” (Lyric)", meta:"US/UK", desc:"Lyric/alt", videoId:"hT_nvWreIhg" },
Â  { type:"MUSIC", title:"Stressed Out â€” twenty one pilots", meta:"US/UK", desc:"Official video", videoId:"pXRviuL6vMY" },
Â  { type:"MUSIC", title:"Heathens â€” twenty one pilots", meta:"US/UK", desc:"Official video", videoId:"UprcpdwuwCg" },
Â  { type:"MUSIC", title:"Shake It Off â€” Taylor Swift", meta:"US/UK", desc:"Official video", videoId:"nfWlot6h_JM" },
Â  { type:"MUSIC", title:"I Don't Wanna Live Forever â€” ZAYN, Taylor Swift", meta:"US/UK", desc:"Official video", videoId:"7F37r50VUTQ" },
Â  { type:"MUSIC", title:"What Do You Mean? â€” Justin Bieber", meta:"US/UK", desc:"Official video", videoId:"DK_0jXPuIr0" },
Â  { type:"MUSIC", title:"Baby â€” Justin Bieber ft. Ludacris", meta:"US/UK", desc:"Official video", videoId:"kffacxfA7G4" },
Â  { type:"MUSIC", title:"One Dance â€” Drake", meta:"US/UK", desc:"Audio/alt", videoId:"iAbnEUA0wpA" },
Â  { type:"MUSIC", title:"Work â€” Rihanna ft. Drake", meta:"US/UK", desc:"Official video", videoId:"HL1UzIK-flA" },
Â  { type:"MUSIC", title:"Happier â€” Marshmello ft. Bastille", meta:"EDM", desc:"Official video", videoId:"m7Bc3pLyij0" },
Â  { type:"MUSIC", title:"Alone â€” Alan Walker", meta:"EDM", desc:"Official video", videoId:"1-xGerv5FOk" },
Â  { type:"MUSIC", title:"The Spectre â€” Alan Walker", meta:"EDM", desc:"Official video", videoId:"wJnBTPUQS5A" },
Â  { type:"MUSIC", title:"Take On Me â€” a-ha", meta:"CLASSIC", desc:"Official video", videoId:"djV11Xbc914" },
Â  { type:"MUSIC", title:"Smells Like Teen Spirit â€” Nirvana", meta:"CLASSIC", desc:"Official video", videoId:"hTWKbfoikeg" },
Â  { type:"MUSIC", title:"Billie Jean â€” Michael Jackson", meta:"CLASSIC", desc:"Official video", videoId:"Zi_XLOBDo_Y" },
Â  { type:"MUSIC", title:"Beat It â€” Michael Jackson", meta:"CLASSIC", desc:"Official video", videoId:"oRdxUFDoQe0" },
Â  { type:"MUSIC", title:"Rolling in the Deep â€” Adele", meta:"US/UK", desc:"Official video", videoId:"rYEDA3JcQqw" },
Â  { type:"MUSIC", title:"Someone Like You â€” Adele", meta:"US/UK", desc:"Official video", videoId:"hLQl3WQQoQ0" },
Â  { type:"MUSIC", title:"Set Fire to the Rain â€” Adele", meta:"US/UK", desc:"Live/alt", videoId:"FlsBObg-1BQ" },
Â  { type:"MUSIC", title:"We Don't Talk Anymore â€” Charlie Puth ft. Selena Gomez", meta:"US/UK", desc:"Official", videoId:"3AtDnEC4zak" }, // (placeholder alt náº¿u trÃ¹ng)
Â  { type:"MUSIC", title:"Attention â€” Charlie Puth", meta:"US/UK", desc:"Official video", videoId:"nfs8NYg7yQM" },
Â  { type:"MUSIC", title:"We Are Young â€” fun. ft. Janelle MonÃ¡e", meta:"US/UK", desc:"Official video", videoId:"Sv6dMFF_yts" },
Â  { type:"MUSIC", title:"Call Me Maybe â€” Carly Rae Jepsen", meta:"US/UK", desc:"Official video", videoId:"fWNaR-rxAic" },
Â  { type:"MUSIC", title:"Party Rock Anthem â€” LMFAO", meta:"US/UK", desc:"Official video", videoId:"KQ6zr6kCPj8" },
Â  { type:"MUSIC", title:"The Lazy Song â€” Bruno Mars", meta:"US/UK", desc:"Official video", videoId:"fLexgOxsZu0" },
Â  { type:"MUSIC", title:"Just the Way You Are â€” Bruno Mars", meta:"US/UK", desc:"Official video", videoId:"LjhCEhWiKXk" },
Â  { type:"MUSIC", title:"Grenade â€” Bruno Mars", meta:"US/UK", desc:"Official video", videoId:"SR6iYWJxHqs" },
Â  { type:"MUSIC", title:"The Fox â€” Ylvis", meta:"GLOBAL", desc:"Official video", videoId:"jofNR_WkoCE" },
Â  { type:"MUSIC", title:"Wake Me Up â€” Avicii", meta:"EDM", desc:"Official video", videoId:"IcrbM1l_BoI" },

Â  { type:"MUSIC", title:"Waiting For Love â€” Avicii", meta:"EDM", desc:"Official video", videoId:"cHHLHGNpCSA" },
Â  { type:"MUSIC", title:"Without Me â€” Halsey", meta:"US/UK", desc:"Official video", videoId:"ZAfAud_M_mg" },
Â  { type:"MUSIC", title:"Hymn for the Weekend â€” Coldplay", meta:"US/UK", desc:"Official video", videoId:"YykjpeuMNEk" },
Â  { type:"MUSIC", title:"Something Just Like This â€” The Chainsmokers & Coldplay", meta:"US/UK", desc:"Official", videoId:"FM7MFYoylVs" },
Â  { type:"MUSIC", title:"A Sky Full of Stars â€” Coldplay", meta:"US/UK", desc:"Official video", videoId:"VPRjCeoBqrI" },
Â  { type:"MUSIC", title:"Counting Stars (Alt)", meta:"US/UK", desc:"Alt", videoId:"hT_nvWreIhg" },
Â  // Latin / Global
Â  { type:"MUSIC", title:"Bailando â€” Enrique Iglesias", meta:"LATIN", desc:"Official video", videoId:"NUsoVlDFqZg" },
Â  { type:"MUSIC", title:"Danza Kuduro â€” Don Omar", meta:"LATIN", desc:"Official video", videoId:"7zp1TbLFPp8" },
Â  { type:"MUSIC", title:"Taki Taki â€” DJ Snake ft. Selena Gomez, Ozuna, Cardi B", meta:"GLOBAL", desc:"Official video", videoId:"ixkoVwKQaJg" },
Â  { type:"MUSIC", title:"Con Calma â€” Daddy Yankee", meta:"LATIN", desc:"Official video", videoId:"DiItGE3eAyQ" },
Â  { type:"MUSIC", title:"Mi Gente â€” J Balvin, Willy William", meta:"LATIN", desc:"Official video", videoId:"wnJ6LuUFpMo" },
Â  // Kpop big
Â  { type:"MUSIC", title:"Dynamite â€” BTS", meta:"K-POP", desc:"Official MV", videoId:"gdZLi9oWNZg" },
Â  { type:"MUSIC", title:"Boy With Luv â€” BTS ft. Halsey", meta:"K-POP", desc:"Official MV", videoId:"XsX3ATc3FbA" },
Â  { type:"MUSIC", title:"How You Like That â€” BLACKPINK", meta:"K-POP", desc:"Official MV", videoId:"ioNng23DkIM" },
Â  { type:"MUSIC", title:"DDU-DU DDU-DU â€” BLACKPINK", meta:"K-POP", desc:"Official MV", videoId:"IHNzOHi8sJs" },
Â  { type:"MUSIC", title:"Kill This Love â€” BLACKPINK", meta:"K-POP", desc:"Official MV", videoId:"2S24-y0Ij3Y" },
Â  // More global hits
Â  { type:"MUSIC", title:"Let Me Love You â€” DJ Snake ft. Justin Bieber", meta:"EDM", desc:"Official", videoId:"euCqAq6BRa4" },
Â  { type:"MUSIC", title:"Rockabye â€” Clean Bandit ft. Sean Paul & Anne-Marie", meta:"US/UK", desc:"Official", videoId:"papuvlVeZg8" },
Â  { type:"MUSIC", title:"Symphony â€” Clean Bandit ft. Zara Larsson", meta:"US/UK", desc:"Official", videoId:"aatr_2MstrI" },
Â  { type:"MUSIC", title:"Closer (Lyric)", meta:"US/UK", desc:"Lyric", videoId:"PT2_F-1esPk" },
Â  { type:"MUSIC", title:"Havana (Live/Alt)", meta:"US/UK", desc:"Alt", videoId:"BQ0mxQXmLsk" },
// âœ… Alias Ä‘á»ƒ PART 3 dÃ¹ng Ä‘Ãºng biáº¿n
const TRACKS = MEDIA.map(x => ({
Â  id: x.videoId,Â  Â  Â  Â  Â  // dÃ¹ng cho youtube embed
Â  title: x.title,
Â  artist: x.meta,Â  Â  Â  Â  Â // hoáº·c tÃ¡ch artist riÃªng náº¿u muá»‘n
Â  tag: x.type,
Â  note: x.desc,
Â  start: x.start || 0
}));
Â  // NOTE:
Â  // Anh muá»‘n chuáº©n 100/100 track â€œtá»· viewâ€ theo Ä‘Ãºng sá»‘ liá»‡u hiá»‡n táº¡i
Â  // => cáº§n web Ä‘á»ƒ kiá»ƒm tra view & videoId chuáº©n. á» Ä‘Ã¢y mÃ¬nh Ä‘Æ°a list phá»• biáº¿n Ä‘á»ƒ cháº¡y ngay.
];
// âœ… náº¿u muá»‘n Ä‘áº£m báº£o Ä‘á»§ 100 pháº§n tá»­:
// console.log("MEDIA size:", MEDIA.length);
/* =========================
Â  Â 3) STATE + STORAGE KEYS
Â  Â ========================= */
const LS = {
Â  mediaState: "MVAPP_MEDIA_STATE_V1",
Â  lyrics:Â  Â  Â "MVAPP_LYRICS_V1"
};
const state = {
Â  idx: 0,
Â  shuffle: false,
Â  repeat: "all", // "off" | "one" | "all"
Â  filter: "",
Â  lastStartSec: 0
};
// Restore saved media state
(function restoreMediaState(){
Â  const saved = safeJSONParse(localStorage.getItem(LS.mediaState), null);
Â  if(!saved) return;
Â  if(Number.isInteger(saved.idx)) state.idx = clamp(saved.idx, 0, TRACKS.length-1);
Â  if(typeof saved.shuffle === "boolean") state.shuffle = saved.shuffle;
Â  if(["off","one","all"].includes(saved.repeat)) state.repeat = saved.repeat;
Â  if(typeof saved.lastStartSec === "number") state.lastStartSec = Math.max(0, saved.lastStartSec);
})();
function saveMediaState(){
Â  localStorage.setItem(LS.mediaState, JSON.stringify({
Â  Â  idx: state.idx,
Â  Â  shuffle: state.shuffle,
Â  Â  repeat: state.repeat,
Â  Â  lastStartSec: state.lastStartSec
Â  }));
}
/* =========================
Â  Â 4) BUILD PLAYLIST UI
Â  Â ========================= */
function filteredTracks(){
Â  const f = norm(state.filter);
Â  if(!f) return TRACKS.map((t,i)=> ({...t, _i:i}));
Â  return TRACKS
Â  Â  .map((t,i)=> ({...t, _i:i}))
Â  Â  .filter(t=>{
Â  Â  Â  const hay = norm(`${t.title} ${t.artist||""} ${t.tag||""} ${t.note||""}`);
Â  Â  Â  return hay.includes(f);
Â  Â  });
}
function renderPlaylist(){
Â  if(!playlistEl) return;
Â  const list = filteredTracks();
Â  if(list.length === 0){
Â  Â  playlistEl.innerHTML = `<div class="item"><h3>No results</h3><p>KhÃ´ng tÃ¬m tháº¥y bÃ i phÃ¹ há»£p.</p></div>`;
Â  Â  return;
Â  }
Â  playlistEl.innerHTML = list.map(t=>{
Â  Â  const isActive = t._i === state.idx;
Â  Â  const meta = [t.artist, t.tag].filter(Boolean).join(" â€¢ ");
Â  Â  return `
Â  Â  Â  <div class="track ${isActive ? "active":""}" data-idx="${t._i}">
Â  Â  Â  Â  <div class="trackTop">
Â  Â  Â  Â  Â  <div class="trackTitle">${escapeHTML(t.title)}</div>
Â  Â  Â  Â  Â  <div class="trackMeta">${escapeHTML(meta || "TRACK")}</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  ${t.note ? `<p class="trackDesc">${escapeHTML(t.note)}</p>` : ``}
Â  Â  Â  </div>
Â  Â  `;
Â  }).join("");
}
function escapeHTML(s){
Â  return (s ?? "")
Â  Â  .toString()
Â  Â  .replaceAll("&","&amp;")
Â  Â  .replaceAll("<","&lt;")
Â  Â  .replaceAll(">","&gt;")
Â  Â  .replaceAll('"',"&quot;")
Â  Â  .replaceAll("'","&#039;");
}
/* =========================
Â  Â 5) YOUTUBE EMBED CONTROL
Â  Â - Use iframe src with autoplay
Â  Â - Start at (track.start OR saved time)
Â  Â ========================= */
function buildYouTubeSrc(videoId, startSec=0){
Â  const s = Math.max(0, Math.floor(startSec||0));
Â  // modestbranding + rel=0 helps cleaner UI
Â  return `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=0&controls=1&rel=0&modestbranding=1&start=${s}`;
}
function loadTrack(index, opts={}){
Â  if(!TRACKS.length) return;
Â  state.idx = clamp(index, 0, TRACKS.length-1);
Â  const t = TRACKS[state.idx];
Â  // decide start time
Â  let startSec = 0;
Â  if(typeof opts.startSec === "number"){
Â  Â  startSec = Math.max(0, opts.startSec);
Â  }else{
Â  Â  // track default start
Â  Â  startSec = Math.max(0, t.start || 0);
Â  Â  // if restoring last play, use it
Â  Â  if(opts.useSavedTime && state.lastStartSec > 0){
Â  Â  Â  startSec = state.lastStartSec;
Â  Â  }
Â  }
Â  if(ytPlayer){
Â  Â  ytPlayer.src = buildYouTubeSrc(t.id, startSec);
Â  }
Â  // UI now playing
Â  if(nowTitleEl) nowTitleEl.textContent = t.title || "Now playing";
Â  if(nowMetaEl)Â  nowMetaEl.textContentÂ  = [t.artist, t.tag].filter(Boolean).join(" â€¢ ") || "";
Â  if(nowTypeEl)Â  nowTypeEl.textContentÂ  = "YouTube";
Â  // highlight active track
Â  renderPlaylist();
Â  // lyrics load for this song
Â  loadLyricsForCurrent(false);
Â  // save
Â  saveMediaState();
}
function nextIndex(){
Â  if(state.shuffle){
Â  Â  if(TRACKS.length <= 1) return state.idx;
Â  Â  let j = state.idx;
Â  Â  while(j === state.idx) j = Math.floor(Math.random() * TRACKS.length);
Â  Â  return j;
Â  }
Â  return (state.idx + 1) % TRACKS.length;
}
function prevIndex(){
Â  if(state.shuffle){
Â  Â  if(TRACKS.length <= 1) return state.idx;
Â  Â  let j = state.idx;
Â  Â  while(j === state.idx) j = Math.floor(Math.random() * TRACKS.length);
Â  Â  return j;
Â  }
Â  return (state.idx - 1 + TRACKS.length) % TRACKS.length;
}
/* =========================
Â  Â 6) LYRICS STORAGE (Bilingual EN/VI)
Â  Â - Save per track.id
Â  Â ========================= */
function readLyricsStore(){
Â  return safeJSONParse(localStorage.getItem(LS.lyrics), {});
}
function writeLyricsStore(obj){
Â  localStorage.setItem(LS.lyrics, JSON.stringify(obj));
}
function lyricsKeyForTrack(track){
Â  return track?.id || "unknown";
}
function saveLyricsForCurrent(){
Â  const t = TRACKS[state.idx];
Â  if(!t) return;
Â  const store = readLyricsStore();
Â  const key = lyricsKeyForTrack(t);
Â  store[key] = {
Â  Â  title: t.title || "",
Â  Â  artist: t.artist || "",
Â  Â  en: (lyricEnEl?.value || "").trim(),
Â  Â  vi: (lyricViEl?.value || "").trim(),
Â  Â  updatedAt: Date.now()
Â  };
Â  writeLyricsStore(store);
Â  toast("âœ… Saved lyrics!");
}
function loadLyricsForCurrent(showToast=true){
Â  const t = TRACKS[state.idx];
Â  if(!t) return;
Â  const store = readLyricsStore();
Â  const key = lyricsKeyForTrack(t);
Â  const data = store[key];
Â  if(lyricEnEl) lyricEnEl.value = data?.en || "";
Â  if(lyricViEl) lyricViEl.value = data?.vi || "";
Â  if(showToast) toast(data ? "ğŸ“¥ Loaded lyrics" : "â„¹ï¸ No saved lyrics");
}
function clearLyricsForCurrent(){
Â  const t = TRACKS[state.idx];
Â  if(!t) return;
Â  const store = readLyricsStore();
Â  const key = lyricsKeyForTrack(t);
Â  if(store[key]) delete store[key];
Â  writeLyricsStore(store);
Â  if(lyricEnEl) lyricEnEl.value = "";
Â  if(lyricViEl) lyricViEl.value = "";
Â  toast("ğŸ§¹ Cleared lyrics");
}
/* =========================
Â  Â 7) COPY LINK + TIME SAVE (MANUAL)
Â  Â - Because iframe can't read exact time,
Â  Â  Â we let user input/save time manually.
Â  Â ========================= */
async function copyCurrentLink(){
Â  const t = TRACKS[state.idx];
Â  if(!t) return;
Â  const url = `https://youtu.be/${t.id}`;
Â  try{
Â  Â  await navigator.clipboard.writeText(url);
Â  Â  toast("ğŸ”— Copied link");
Â  }catch(e){
Â  Â  toast("âŒ Copy failed");
Â  }
}
function saveTimeManual(){
Â  // If anh cÃ³ input #timeSec thÃ¬ dÃ¹ng nÃ³
Â  const timeEl = $("#timeSec");
Â  let sec = 0;
Â  if(timeEl){
Â  Â  sec = parseFloat(timeEl.value || "0");
Â  }else{
Â  Â  const raw = prompt("Nháº­p sá»‘ giÃ¢y (start time) Ä‘á»ƒ lÆ°u:", "0");
Â  Â  if(raw === null) return;
Â  Â  sec = parseFloat(raw);
Â  }
Â  if(!Number.isFinite(sec) || sec < 0) sec = 0;
Â  state.lastStartSec = Math.floor(sec);
Â  saveMediaState();
Â  toast("â±ï¸ Saved start time");
}
function resetTimeManual(){
Â  state.lastStartSec = 0;
Â  saveMediaState();
Â  toast("âŸ² Reset saved time");
}
/* =========================
Â  Â 8) EVENT BINDING (NO DUPLICATE)
Â  Â - Use event delegation for playlist
Â  Â - Guard double-binding with a flag
Â  Â ========================= */
let BOUND = false;
function bindEventsOnce(){
Â  if(BOUND) return;
Â  BOUND = true;
Â  // Playlist click (delegation)
Â  if(playlistEl){
Â  Â  playlistEl.addEventListener("click", (e)=>{
Â  Â  Â  const card = e.target.closest(".track");
Â  Â  Â  if(!card) return;
Â  Â  Â  const idx = parseInt(card.dataset.idx, 10);
Â  Â  Â  if(!Number.isInteger(idx)) return;
Â  Â  Â  state.lastStartSec = 0; // reset manual saved time when user chooses new track
Â  Â  Â  loadTrack(idx, { startSec: TRACKS[idx]?.start || 0 });
Â  Â  });
Â  }
Â  // Search/filter
Â  if(searchEl){
Â  Â  searchEl.addEventListener("input", ()=>{
Â  Â  Â  state.filter = searchEl.value || "";
Â  Â  Â  renderPlaylist();
Â  Â  });
Â  }
Â  // Controls
Â  btnNext?.addEventListener("click", ()=>{
Â  Â  if(state.repeat === "one"){
Â  Â  Â  // replay same
Â  Â  Â  state.lastStartSec = 0;
Â  Â  Â  loadTrack(state.idx, { startSec: TRACKS[state.idx]?.start || 0 });
Â  Â  Â  return;
Â  Â  }
Â  Â  state.lastStartSec = 0;
Â  Â  loadTrack(nextIndex(), { startSec: 0 });
Â  });
Â  btnPrev?.addEventListener("click", ()=>{
Â  Â  state.lastStartSec = 0;
Â  Â  loadTrack(prevIndex(), { startSec: 0 });
Â  });

Â  btnShuffle?.addEventListener("click", ()=>{
Â  Â  state.shuffle = !state.shuffle;
Â  Â  btnShuffle.classList.toggle("active", state.shuffle);
Â  Â  saveMediaState();
Â  Â  toast(state.shuffle ? "ğŸ”€ Shuffle ON" : "â¡ï¸ Shuffle OFF");
Â  });
Â  btnRepeat?.addEventListener("click", ()=>{
Â  Â  // cycle: all -> one -> off -> all
Â  Â  state.repeat = (state.repeat === "all") ? "one" : (state.repeat === "one" ? "off" : "all");
Â  Â  btnRepeat.dataset.mode = state.repeat; // optional for CSS
Â  Â  saveMediaState();
Â  Â  toast(`ğŸ” Repeat: ${state.repeat.toUpperCase()}`);
Â  });
Â  btnCopyLink?.addEventListener("click", copyCurrentLink);
Â  btnSaveTime?.addEventListener("click", saveTimeManual);
Â  btnResetTime?.addEventListener("click", resetTimeManual);
Â  // Lyrics buttons
Â  btnSaveLyric?.addEventListener("click", saveLyricsForCurrent);
Â  btnLoadLyric?.addEventListener("click", ()=> loadLyricsForCurrent(true));
Â  btnClearLyric?.addEventListener("click", clearLyricsForCurrent);
Â  // Keyboard shortcuts (optional)
Â  document.addEventListener("keydown", (e)=>{
Â  Â  if(e.target && ["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName)) return;
Â  Â  if(e.key === "ArrowRight") btnNext?.click();
Â  Â  if(e.key === "ArrowLeft")Â  btnPrev?.click();
Â  Â  if(e.key.toLowerCase() === "s") btnShuffle?.click();
Â  Â  if(e.key.toLowerCase() === "r") btnRepeat?.click();
Â  });
}
/* =========================
Â  Â 9) INIT
Â  Â ========================= */
function initMediaPlayer(){
Â  // initial render + apply button UI state
Â  renderPlaylist();
Â  if(btnShuffle) btnShuffle.classList.toggle("active", state.shuffle);
Â  if(btnRepeat)Â  btnRepeat.dataset.mode = state.repeat;
Â  bindEventsOnce();
Â  // Load initial track
Â  loadTrack(state.idx, { useSavedTime:true });
Â  toast("âœ… Media Player ready");
}
/* Run after DOM ready */
if(document.readyState === "loading"){
Â  document.addEventListener("DOMContentLoaded", initMediaPlayer, { once:true });
}else{
Â  initMediaPlayer();
}
/* =========================================================
Â  Â END PART 3
Â  Â ========================================================= */
/* =========================================================
Â  Â PART 4 â€” TRANSLATE (ENâ‡„VI) + LYRICS LIBRARY (Backup)
Â  Â âœ… Translate EN<->VI (offline stub + hook for AI later)
Â  Â âœ… Apply translation into Lyrics EN/VI
Â  Â âœ… Export/Import lyrics store JSON (backup)
Â  Â âœ… Quick library viewer (optional)
Â  Â ========================================================= */
/* =========================
Â  Â 1) DOM (ADD THESE IDs IN HTML)
Â  Â =========================
Â  Â - <textarea id="trSrc"></textarea>
Â  Â - <textarea id="trOut" readonly></textarea>
Â  Â - <select id="trDir">
Â  Â  Â  Â <option value="en2vi">EN â†’ VI</option>
Â  Â  Â  Â <option value="vi2en">VI â†’ EN</option>
Â  Â  Â </select>
Â  Â - <button id="btnTranslate">Translate</button>
Â  Â - <button id="btnSwapTr">Swap</button>
Â  Â - <button id="btnApplyToLyrics">Apply â†’ Lyrics</button>
Â  Â Backup:
Â  Â - <button id="btnExportLyrics">Export Lyrics JSON</button>
Â  Â - <input type="file" id="fileImportLyrics" accept="application/json" hidden />
Â  Â - <button id="btnImportLyrics">Import Lyrics JSON</button>
Â  Â - <button id="btnClearAllLyrics">Clear ALL Lyrics</button>
Â  Â Optional library box:
Â  Â - <div id="lyricsLibrary"></div>
Â  Â - <input id="lyricsSearch" placeholder="Search saved lyrics..." />
*/
const trSrcElÂ  Â = $("#trSrc");
const trOutElÂ  Â = $("#trOut");
const trDirElÂ  Â = $("#trDir");
const btnTranslate = $("#btnTranslate");
const btnSwapTrÂ  Â  = $("#btnSwapTr");
const btnApplyToLyrics = $("#btnApplyToLyrics");
const btnExportLyrics = $("#btnExportLyrics");
const btnImportLyrics = $("#btnImportLyrics");
const fileImportLyrics= $("#fileImportLyrics");
const btnClearAllLyrics = $("#btnClearAllLyrics");
const lyricsLibElÂ  = $("#lyricsLibrary");
const lyricsSearchEl = $("#lyricsSearch");
/* =========================
Â  Â 2) TRANSLATE CORE
Â  Â - Option A (default): offline "smart stub" (no real translation)
Â  Â - Option B: plug in AI API later (OpenAI / other)
Â  Â ========================= */
// âœ… Offline stub: chá»‰ Ä‘á»ƒ demo luá»“ng + cÃ³ thá»ƒ thay báº±ng AI sau
function offlineTranslateStub(text, dir){
Â  const t = (text || "").trim();
Â  if(!t) return "";
Â  // Demo: náº¿u en2vi thÃ¬ gáº¯n prefix [VI], vi2en thÃ¬ [EN]
Â  // (Anh muá»‘n dá»‹ch tháº­t thÃ¬ báº­t AI hook phÃ­a dÆ°á»›i)
Â  return dir === "en2vi"
Â  Â  ? `ã€VIã€‘${t}`
Â  Â  : `ã€ENã€‘${t}`;
}
/*
âœ… AI HOOK (OPTIONAL)
- Anh cÃ³ thá»ƒ thay function translateAI() báº±ng API anh muá»‘n dÃ¹ng.
- á» Ä‘Ã¢y em Ä‘á»ƒ khung máº«u, KHÃ”NG tá»± gá»i máº¡ng.
*/
async function translateAI(text, dir){
Â  // TODO: tÃ­ch há»£p API tháº­t sau (OpenAI/translate server)
Â  // return await callYourAPI(text, dir);
Â  return offlineTranslateStub(text, dir);
}
async function runTranslate(){
Â  const dir = trDirEl?.value || "en2vi";
Â  const input = trSrcEl?.value || "";
Â  if(!input.trim()){
Â  Â  toast("Nháº­p ná»™i dung cáº§n dá»‹ch trÆ°á»›c Ä‘Ã£ anh.");
Â  Â  return;
Â  }
Â  // UI busy
Â  if(btnTranslate) btnTranslate.disabled = true;
Â  if(trOutEl) trOutEl.value = "Translating...";
Â  try{
Â  Â  const out = await translateAI(input, dir);
Â  Â  if(trOutEl) trOutEl.value = out || "";
Â  Â  toast("âœ… Done");
Â  }catch(e){
Â  Â  if(trOutEl) trOutEl.value = "";
Â  Â  toast("âŒ Translate error");
Â  Â  console.error(e);
Â  }finally{
Â  Â  if(btnTranslate) btnTranslate.disabled = false;
Â  }
}
function swapTranslate(){
Â  if(!trDirEl) return;
Â  const dir = trDirEl.value || "en2vi";
Â  trDirEl.value = (dir === "en2vi") ? "vi2en" : "en2vi";
Â  // swap text
Â  const a = trSrcEl?.value || "";
Â  const b = trOutEl?.value || "";
Â  if(trSrcEl) trSrcEl.value = b;
Â  if(trOutEl) trOutEl.value = a;
}
/* =========================
Â  Â 3) APPLY TRANSLATION â†’ LYRICS (EN/VI)
Â  Â - If dir en2vi: src is EN, out is VI
Â  Â - If dir vi2en: src is VI, out is EN
Â  Â ========================= */
function applyTranslateToLyrics(){
Â  const dir = trDirEl?.value || "en2vi";
Â  const src = (trSrcEl?.value || "").trim();
Â  const out = (trOutEl?.value || "").trim();
Â  if(!src && !out){
Â  Â  toast("ChÆ°a cÃ³ ná»™i dung Ä‘á»ƒ apply.");
Â  Â  return;
Â  }
Â  if(dir === "en2vi"){
Â  Â  if(lyricEnEl) lyricEnEl.value = src;
Â  Â  if(lyricViEl) lyricViEl.value = out;
Â  }else{
Â  Â  if(lyricViEl) lyricViEl.value = src;
Â  Â  if(lyricEnEl) lyricEnEl.value = out;
Â  }
Â  toast("âœ… Applied â†’ Lyrics");
}
/* =========================
Â  Â 4) LYRICS BACKUP: EXPORT / IMPORT JSON
Â  Â ========================= */
function exportLyricsJSON(){
Â  const store = readLyricsStore();
Â  const payload = {
Â  Â  app: "MultiVerseApp",
Â  Â  type: "LyricsBackup",
Â  Â  version: 1,
Â  Â  exportedAt: new Date().toISOString(),
Â  Â  total: Object.keys(store).length,
Â  Â  data: store
Â  };
Â  const blob = new Blob([JSON.stringify(payload, null, 2)], { type:"application/json" });
Â  const urlÂ  = URL.createObjectURL(blob);
Â  const a = document.createElement("a");
Â  a.href = url;
Â  a.download = `lyrics-backup-${Date.now()}.json`;
Â  document.body.appendChild(a);
Â  a.click();
Â  a.remove();
Â  URL.revokeObjectURL(url);
Â  toast("ğŸ“¦ Exported lyrics JSON");
}
function importLyricsJSONFile(file){
Â  return new Promise((resolve, reject)=>{
Â  Â  const fr = new FileReader();
Â  Â  fr.onload = ()=>{
Â  Â  Â  try{
Â  Â  Â  Â  const obj = JSON.parse(fr.result);
Â  Â  Â  Â  if(!obj || typeof obj !== "object") throw new Error("Invalid JSON");
Â  Â  Â  Â  const data = obj.data && typeof obj.data === "object" ? obj.data : null;
Â  Â  Â  Â  if(!data) throw new Error("Missing data field");
Â  Â  Â  Â  // merge into current
Â  Â  Â  Â  const cur = readLyricsStore();
Â  Â  Â  Â  const merged = { ...cur, ...data };
Â  Â  Â  Â  writeLyricsStore(merged);
Â  Â  Â  Â  // reload current track lyrics
Â  Â  Â  Â  loadLyricsForCurrent(false);
Â  Â  Â  Â  renderLyricsLibrary();
Â  Â  Â  Â  toast(`âœ… Imported (${Object.keys(data).length})`);
Â  Â  Â  Â  resolve(true);
Â  Â  Â  }catch(e){
Â  Â  Â  Â  toast("âŒ Import failed (JSON invalid)");
Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  reject(e);
Â  Â  Â  }
Â  Â  };
Â  Â  fr.onerror = ()=> reject(fr.error);
Â  Â  fr.readAsText(file);
Â  });
}
function clearAllLyrics(){
Â  if(!confirm("XÃ³a Táº¤T Cáº¢ lyrics Ä‘Ã£ lÆ°u? (KhÃ´ng khÃ´i phá»¥c Ä‘Æ°á»£c)")) return;
Â  writeLyricsStore({});
Â  loadLyricsForCurrent(false);
Â  renderLyricsLibrary();
Â  toast("ğŸ§¹ Cleared ALL lyrics");
}
/* =========================
Â  Â 5) OPTIONAL: LYRICS LIBRARY VIEWER
Â  Â ========================= */
function renderLyricsLibrary(){
Â  if(!lyricsLibEl) return;
Â  const q = norm(lyricsSearchEl?.value || "");
Â  const store = readLyricsStore();
Â  const items = Object.entries(store)
Â  Â  .map(([id, v]) => ({ id, ...v }))
Â  Â  .sort((a,b)=> (b.updatedAt||0) - (a.updatedAt||0))
Â  Â  .filter(it=>{
Â  Â  Â  if(!q) return true;
Â  Â  Â  const hay = norm(`${it.title||""} ${it.artist||""} ${it.en||""} ${it.vi||""}`);
Â  Â  Â  return hay.includes(q);
Â  Â  });
Â  if(items.length === 0){
Â  Â  lyricsLibEl.innerHTML = `<div class="item"><h3>No saved lyrics</h3><p>ChÆ°a cÃ³ lyrics nÃ o Ä‘Æ°á»£c lÆ°u.</p></div>`;
Â  Â  return;
Â  }
Â  lyricsLibEl.innerHTML = items.map(it=>{
Â  Â  const time = it.updatedAt ? new Date(it.updatedAt).toLocaleString() : "";
Â  Â  const enShort = (it.en||"").slice(0,120);
Â  Â  const viShort = (it.vi||"").slice(0,120);
Â  Â  return `
Â  Â  Â  <div class="track" data-lyid="${escapeHTML(it.id)}" style="cursor:pointer">
Â  Â  Â  Â  <div class="trackTop">
Â  Â  Â  Â  Â  <div class="trackTitle">${escapeHTML(it.title || it.id)}</div>
Â  Â  Â  Â  Â  <div class="trackMeta">${escapeHTML((it.artist||"") + (time ? " â€¢ " + time : ""))}</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p class="trackDesc"><b>EN:</b> ${escapeHTML(enShort)}${(it.en||"").length>120?"â€¦":""}</p>
Â  Â  Â  Â  <p class="trackDesc"><b>VI:</b> ${escapeHTML(viShort)}${(it.vi||"").length>120?"â€¦":""}</p>
Â  Â  Â  </div>
Â  Â  `;
Â  }).join("");
}
function bindLyricsLibraryEventsOnce(){
Â  if(!lyricsLibEl) return;
Â  if(bindLyricsLibraryEventsOnce._bound) return;
Â  bindLyricsLibraryEventsOnce._bound = true;
Â  // click an item -> load lyrics into textareas
Â  lyricsLibEl.addEventListener("click", (e)=>{
Â  Â  const card = e.target.closest("[data-lyid]");
Â  Â  if(!card) return;
Â  Â  const id = card.getAttribute("data-lyid");
Â  Â  const store = readLyricsStore();
Â  Â  const data = store[id];
Â  Â  if(!data){
Â  Â  Â  toast("Not found");
Â  Â  Â  return;
Â  Â  }
Â  Â  if(lyricEnEl) lyricEnEl.value = data.en || "";
Â  Â  if(lyricViEl) lyricViEl.value = data.vi || "";
Â  Â  toast("ğŸ“¥ Loaded from library â†’ Lyrics box");
Â  });
Â  lyricsSearchEl?.addEventListener("input", renderLyricsLibrary);
}
/* =========================
Â  Â 6) EVENTS
Â  Â ========================= */
function initTranslateAndBackup(){
Â  btnTranslate?.addEventListener("click", runTranslate);
Â  btnSwapTr?.addEventListener("click", swapTranslate);
Â  btnApplyToLyrics?.addEventListener("click", applyTranslateToLyrics);
Â  btnExportLyrics?.addEventListener("click", exportLyricsJSON);
Â  btnImportLyrics?.addEventListener("click", ()=>{
Â  Â  if(!fileImportLyrics) return toast("Missing #fileImportLyrics");
Â  Â  fileImportLyrics.click();
Â  });
Â  fileImportLyrics?.addEventListener("change", async ()=>{
Â  Â  const file = fileImportLyrics.files?.[0];
Â  Â  if(!file) return;
Â  Â  await importLyricsJSONFile(file);
Â  Â  fileImportLyrics.value = "";
Â  });
Â  btnClearAllLyrics?.addEventListener("click", clearAllLyrics);
Â  bindLyricsLibraryEventsOnce();
Â  renderLyricsLibrary();
}
// Run after PART 3 init (safe)
if(document.readyState === "loading"){
Â  document.addEventListener("DOMContentLoaded", initTranslateAndBackup, { once:true });
}else{
Â  initTranslateAndBackup();
}
/* =========================================================
Â  Â END PART 4
Â  Â ========================================================= */
<!-- =========================================================
Â  Â  Â PART 5A â€” TRANSLATE + LYRICS LIBRARY (HTML UI)
Â  Â  Â Must match IDs used in PART 4
Â  Â  Â ========================================================= -->
<section class="card">
Â  <div class="cardHead">
Â  Â  <h2>Translate (EN â‡„ VI)</h2>
Â  Â  <p class="muted">Dá»‹ch nhanh Ä‘á»ƒ há»c tiáº¿ng Anh, rá»“i apply vÃ o Lyrics.</p>
Â  </div>
Â  <div class="trGrid">
Â  Â  <div class="trCol">
Â  Â  Â  <label class="lbl">Input</label>
Â  Â  Â  <textarea id="trSrc" class="ta" rows="6" placeholder="Paste English or Vietnamese here..."></textarea>
Â  Â  Â  <div class="trRow">
Â  Â  Â  Â  <select id="trDir" class="sel">
Â  Â  Â  Â  Â  <option value="en2vi">EN â†’ VI</option>
Â  Â  Â  Â  Â  <option value="vi2en">VI â†’ EN</option>
Â  Â  Â  Â  </select>
Â  Â  Â  Â  <button id="btnTranslate" class="btn primary">Translate</button>
Â  Â  Â  Â  <button id="btnSwapTr" class="btn">Swap</button>
Â  Â  Â  Â  <button id="btnApplyToLyrics" class="btn ok">Apply â†’ Lyrics</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  <div class="trCol">
Â  Â  Â  <label class="lbl">Output</label>
Â  Â  Â  <textarea id="trOut" class="ta" rows="6" placeholder="Translation result..." readonly></textarea>
Â  Â  Â  <div class="hint">
Â  Â  Â  Â  <span class="dot"></span>
Â  Â  Â  Â  <span>Tip: báº¥m <b>Apply â†’ Lyrics</b> Ä‘á»ƒ tá»± Ä‘á»• vÃ o Ã´ Lyrics EN/VI cá»§a bÃ i Ä‘ang phÃ¡t.</span>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</section>
<section class="card">
Â  <div class="cardHead">
Â  Â  <h2>Lyrics Library (Saved)</h2>
Â  Â  <p class="muted">LÆ°u lyrics theo tá»«ng bÃ i. CÃ³ thá»ƒ backup/export Ä‘á»ƒ khÃ´ng máº¥t.</p>
Â  </div>
Â  <div class="libTop">
Â  Â  <input id="lyricsSearch" class="inp" placeholder="Search saved lyrics..." />
Â  Â  <div class="libBtns">
Â  Â  Â  <button id="btnExportLyrics" class="btn">Export JSON</button>
Â  Â  Â  <button id="btnImportLyrics" class="btn">Import JSON</button>
Â  Â  Â  <button id="btnClearAllLyrics" class="btn danger">Clear All</button>
Â  Â  Â  <input type="file" id="fileImportLyrics" accept="application/json" hidden />
Â  Â  </div>
Â  </div>
Â  <div id="lyricsLibrary" class="libBox">
Â  Â  <!-- render by JS -->
Â  </div>
</section>
<!-- =========================================================
Â  Â  Â END PART 5A
Â  Â  Â ========================================================= -->
/* =========================================================
Â  Â PART 5B â€” TRANSLATE + LYRICS LIBRARY (CSS)
Â  Â ========================================================= */
.card{
Â  border:1px solid var(--line, rgba(255,255,255,.12));
Â  border-radius:18px;
Â  padding:16px;
Â  background:rgba(255,255,255,.04);
Â  margin:14px 0;
}
.cardHead h2{
Â  margin:0 0 6px 0;
Â  font-size:18px;
Â  letter-spacing:.2px;
}
.muted{
Â  opacity:.78;
Â  margin:0;
Â  font-size:13px;
}

.lbl{
Â  display:block;
Â  font-size:12px;
Â  opacity:.8;
Â  margin:8px 0 6px;
}
.trGrid{
Â  display:grid;
Â  grid-template-columns: 1fr 1fr;
Â  gap:12px;
Â  margin-top:10px;
}
.trCol{ display:flex; flex-direction:column; gap:8px; }
.ta{
Â  width:100%;
Â  border-radius:14px;
Â  border:1px solid var(--line, rgba(255,255,255,.12));
Â  background:rgba(0,0,0,.18);
Â  padding:12px;
Â  color:inherit;
Â  outline:none;
Â  resize:vertical;
Â  line-height:1.4;
}
.inp{
Â  width:100%;
Â  border-radius:14px;
Â  border:1px solid var(--line, rgba(255,255,255,.12));
Â  background:rgba(0,0,0,.18);
Â  padding:10px 12px;
Â  color:inherit;
Â  outline:none;
}
.sel{
Â  border-radius:14px;
Â  border:1px solid var(--line, rgba(255,255,255,.12));
Â  background:rgba(0,0,0,.18);
Â  padding:10px 12px;
Â  color:inherit;
Â  outline:none;
Â  min-width:140px;
}
.trRow{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
Â  align-items:center;
}
.btn{
Â  border:1px solid var(--line, rgba(255,255,255,.12));
Â  background:rgba(255,255,255,.06);
Â  color:inherit;
Â  padding:10px 12px;
Â  border-radius:14px;
Â  cursor:pointer;
Â  transition:.15s ease;
Â  user-select:none;
}
.btn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.09); }
.btn:active{ transform:translateY(0px); opacity:.9; }

.btn.primary{
Â  background:rgba(0, 140, 255, .22);
Â  border-color:rgba(0, 140, 255, .35);
}
.btn.ok{
Â  background:rgba(0, 200, 120, .18);
Â  border-color:rgba(0, 200, 120, .32);
}
.btn.danger{
Â  background:rgba(255, 60, 60, .18);
Â  border-color:rgba(255, 60, 60, .32);
}
.hint{
Â  display:flex;
Â  align-items:center;
Â  gap:8px;
Â  font-size:12px;
Â  opacity:.85;
Â  padding:8px 10px;
Â  border-radius:14px;
Â  border:1px dashed rgba(255,255,255,.12);
Â  background:rgba(255,255,255,.03);
}
.hint .dot{
Â  width:8px; height:8px;
Â  border-radius:50%;
Â  background:rgba(0, 200, 120, .9);
Â  display:inline-block;
}
.libTop{
Â  display:flex;
Â  gap:10px;
Â  align-items:center;
Â  margin-top:10px;
Â  flex-wrap:wrap;
}
.libBtns{
Â  display:flex;
Â  gap:10px;
Â  flex-wrap:wrap;
}
.libBox{
Â  margin-top:12px;
Â  display:grid;
Â  gap:10px;
}
/* Make library items consistent with playlist style */
.libBox .track{
Â  border:1px solid var(--line, rgba(255,255,255,.12));
Â  border-radius:16px;
Â  background:rgba(255,255,255,.04);
Â  padding:12px;
Â  transition:.18s ease;
}
.libBox .track:hover{ transform:translateY(-1px); background:rgba(255,255,255,.06); }
.libBox .trackTitle{ font-weight:700; margin-bottom:4px; }
.libBox .trackMeta{ font-size:12px; opacity:.75; }
.libBox .trackDesc{ margin:6px 0 0; font-size:12px; opacity:.88; }
/* Responsive */
@media (max-width: 900px){
Â  .trGrid{ grid-template-columns:1fr; }
Â  .sel{ min-width:160px; }
}
/* =========================================================
Â  Â PART 6 â€” TRANSLATE ENGINE (Realistic)
Â  Â âœ… Mode A: Offline mini translate (no internet)
Â  Â âœ… Mode B: Online API translate (optional)
Â  Â âœ… Apply result into Lyrics EN/VI of current track
Â  Â âœ… Save last translate state
Â  Â ========================================================= */
/* =========================
Â  Â 0) DOM (Must match PART 5)
Â  Â ========================= */
const trSrcElÂ  Â = $("#trSrc");
const trOutElÂ  Â = $("#trOut");
const trDirElÂ  Â = $("#trDir");
const btnTrÂ  Â  Â = $("#btnTranslate");
const btnSwapTr = $("#btnSwapTr");
const btnApplyÂ  = $("#btnApplyToLyrics");
/* =========================
Â  Â 1) SETTINGS + STORAGE
Â  Â ========================= */
const TR = {
Â  LS_KEY: "MVAPP_TRANSLATE_STATE_V1",
Â  MODE: "offline", // "offline" | "api"
Â  // Náº¿u dÃ¹ng API: Ä‘iá»n endpoint á»Ÿ Ä‘Ã¢y
Â  // LibreTranslate example: https://libretranslate.com/translate
Â  // Self-hosted: https://your-domain.com/translate
Â  API_URL: "",
Â  // timeout fetch (ms)
Â  TIMEOUT: 12000
};
function restoreTranslateState(){
Â  const saved = safeJSONParse(localStorage.getItem(TR.LS_KEY), null);
Â  if(!saved) return;
Â  if(trSrcEl && typeof saved.src === "string") trSrcEl.value = saved.src;
Â  if(trOutEl && typeof saved.out === "string") trOutEl.value = saved.out;
Â  if(trDirEl && (saved.dir === "en2vi" || saved.dir === "vi2en")) trDirEl.value = saved.dir;
Â  if(typeof saved.mode === "string" && (saved.mode === "offline" || saved.mode === "api")) TR.MODE = saved.mode;
Â  if(typeof saved.apiUrl === "string") TR.API_URL = saved.apiUrl;
}
function saveTranslateState(){
Â  localStorage.setItem(TR.LS_KEY, JSON.stringify({
Â  Â  src: trSrcEl?.value || "",
Â  Â  out: trOutEl?.value || "",
Â  Â  dir: trDirEl?.value || "en2vi",
Â  Â  mode: TR.MODE,
Â  Â  apiUrl: TR.API_URL
Â  }));
}
/* =========================
Â  Â 2) MODE A â€” OFFLINE MINI TRANSLATE
Â  Â - KhÃ´ng thá»ƒ dá»‹ch chuáº©n 100% nhÆ° Google,
Â  Â  Â nhÆ°ng Ä‘á»§ cho cÃ¢u cÆ¡ báº£n + há»c tá»« vá»±ng.
Â  Â ========================= */
const MINI_DICT_EN2VI = {
Â  "hello":"xin chÃ o",
Â  "hi":"chÃ o",
Â  "good":"tá»‘t",
Â  "bad":"tá»‡",
Â  "morning":"buá»•i sÃ¡ng",
Â  "night":"buá»•i tá»‘i",
Â  "thank you":"cáº£m Æ¡n",
Â  "thanks":"cáº£m Æ¡n",
Â  "sorry":"xin lá»—i",
Â  "love":"yÃªu",
Â  "miss":"nhá»›",
Â  "you":"báº¡n",
Â  "i":"tÃ´i",
Â  "we":"chÃºng tÃ´i",
Â  "they":"há»",
Â  "he":"anh áº¥y",
Â  "she":"cÃ´ áº¥y",
Â  "music":"Ã¢m nháº¡c",
Â  "song":"bÃ i hÃ¡t",
Â  "lyrics":"lá»i bÃ i hÃ¡t",
Â  "today":"hÃ´m nay",
Â  "tomorrow":"ngÃ y mai",
Â  "yesterday":"hÃ´m qua",
Â  "happy":"vui",
Â  "sad":"buá»“n",
Â  "beautiful":"Ä‘áº¹p",
Â  "family":"gia Ä‘Ã¬nh",
Â  "friend":"báº¡n",
Â  "work":"cÃ´ng viá»‡c",
Â  "study":"há»c",
Â  "school":"trÆ°á»ng",
Â  "home":"nhÃ "
};
// VI->EN táº¡o ngÆ°á»£c nhanh
const MINI_DICT_VI2EN = Object.fromEntries(
Â  Object.entries(MINI_DICT_EN2VI).map(([en,vi]) => [vi,en])
);
function offlineTranslate(text, dir){
Â  const raw = (text || "").trim();
Â  if(!raw) return "";

Â  // Dá»‹ch theo cá»¥m trÆ°á»›c (phrase), rá»“i theo tá»«
Â  const dict = (dir === "en2vi") ? MINI_DICT_EN2VI : MINI_DICT_VI2EN;
Â  // 1) thay phrase dÃ i trÆ°á»›c
Â  let out = raw;
Â  const phrases = Object.keys(dict).sort((a,b)=> b.length - a.length);
Â  phrases.forEach(k=>{
Â  Â  const safe = k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
Â  Â  const rx = new RegExp(`\\b${safe}\\b`, "gi");
Â  Â  out = out.replace(rx, (m)=> {
Â  Â  Â  // giá»¯ hoa chá»¯ cÃ¡i Ä‘áº§u náº¿u cÃ³
Â  Â  Â  const rep = dict[k];
Â  Â  Â  if(!rep) return m;
Â  Â  Â  const isCap = m[0] === m[0].toUpperCase();
Â  Â  Â  return isCap ? rep.charAt(0).toUpperCase() + rep.slice(1) : rep;
Â  Â  });
Â  });
Â  return out;
}
/* =========================
Â  Â 3) MODE B â€” ONLINE API TRANSLATE
Â  Â - Anh cÃ³ thá»ƒ dÃ¹ng LibreTranslate/self-host.
Â  Â - Payload chuáº©n:
Â  Â  Â { q, source, target, format:"text" }
Â  Â ========================= */
function fetchWithTimeout(url, opts={}, timeout=12000){
Â  return new Promise((resolve, reject)=>{
Â  Â  const ctrl = new AbortController();
Â  Â  const id = setTimeout(()=> ctrl.abort(), timeout);
Â  Â  fetch(url, { ...opts, signal: ctrl.signal })
Â  Â  Â  .then(res => { clearTimeout(id); resolve(res); })
Â  Â  Â  .catch(err => { clearTimeout(id); reject(err); });
Â  });
}
async function apiTranslate(text, dir){
Â  if(!TR.API_URL){
Â  Â  throw new Error("Missing API URL");
Â  }
Â  const source = dir === "en2vi" ? "en" : "vi";
Â  const target = dir === "en2vi" ? "vi" : "en";

Â  const body = {
Â  Â  q: text,
Â  Â  source,
Â  Â  target,
Â  Â  format: "text"
Â  };
Â  const res = await fetchWithTimeout(TR.API_URL, {
Â  Â  method: "POST",
Â  Â  headers: { "Content-Type":"application/json" },
Â  Â  body: JSON.stringify(body)
Â  }, TR.TIMEOUT);
Â  if(!res.ok){
Â  Â  const t = await res.text().catch(()=> "");
Â  Â  throw new Error(`API error ${res.status}: ${t.slice(0,200)}`);
Â  }
Â  const data = await res.json();
Â  // LibreTranslate: { translatedText: "..." }
Â  const translated = data?.translatedText || data?.translation || data?.result;
Â  if(typeof translated !== "string") throw new Error("Bad API response");
Â  return translated;
}
/* =========================
Â  Â 4) MAIN TRANSLATE ACTION
Â  Â ========================= */
async function doTranslate(){
Â  const text = (trSrcEl?.value || "").trim();
Â  const dirÂ  = trDirEl?.value || "en2vi";
Â  if(!text){
Â  Â  toast("âš ï¸ Please enter text to translate");
Â  Â  return;
Â  }
Â  try{
Â  Â  toast("â³ Translating...");
Â  Â  let result = "";
Â  Â  if(TR.MODE === "api"){
Â  Â  Â  result = await apiTranslate(text, dir);
Â  Â  }else{
Â  Â  Â  result = offlineTranslate(text, dir);
Â  Â  }
Â  Â  if(trOutEl) trOutEl.value = result;
Â  Â  saveTranslateState();
Â  Â  toast("âœ… Done");
Â  }catch(e){
Â  Â  console.error(e);
Â  Â  toast("âŒ Translate failed (check MODE/API URL)");
Â  }
}
/* =========================
Â  Â 5) SWAP + APPLY TO LYRICS
Â  Â ========================= */
function swapTranslate(){
Â  const a = trSrcEl?.value || "";
Â  const b = trOutEl?.value || "";
Â  if(trSrcEl) trSrcEl.value = b;
Â  if(trOutEl) trOutEl.value = a;
Â  // swap direction
Â  const d = trDirEl?.value || "en2vi";
Â  if(trDirEl) trDirEl.value = (d === "en2vi") ? "vi2en" : "en2vi";
Â  saveTranslateState();
Â  toast("ğŸ” Swapped");
}

function applyToLyrics(){
Â  const dir = trDirEl?.value || "en2vi";
Â  const out = (trOutEl?.value || "").trim();
Â  const src = (trSrcEl?.value || "").trim();
Â  if(!out && !src){
Â  Â  toast("âš ï¸ Nothing to apply");
Â  Â  return;
Â  }
Â  // Náº¿u ENâ†’VI: src lÃ  EN, out lÃ  VI
Â  if(dir === "en2vi"){
Â  Â  if(lyricEnEl) lyricEnEl.value = src;
Â  Â  if(lyricViEl) lyricViEl.value = out;
Â  }else{
Â  Â  // VIâ†’EN: src lÃ  VI, out lÃ  EN
Â  Â  if(lyricViEl) lyricViEl.value = src;
Â  Â  if(lyricEnEl) lyricEnEl.value = out;
Â  }
Â  toast("âœ… Applied to Lyrics");
}
/* =========================
Â  Â 6) QUICK SETTINGS UI (Optional)
Â  Â - KhÃ´ng cáº§n HTML thÃªm.
Â  Â - DÃ¹ng phÃ­m táº¯t Ä‘á»ƒ Ä‘á»•i MODE.
Â  Â ========================= */
function toggleTranslateMode(){
Â  TR.MODE = (TR.MODE === "offline") ? "api" : "offline";
Â  saveTranslateState();
Â  toast(`ğŸŒ Translate mode: ${TR.MODE.toUpperCase()}`);
Â  if(TR.MODE === "api" && !TR.API_URL){
Â  Â  toast("â„¹ï¸ API mode ON but API_URL is empty");
Â  }
}
/* =========================
Â  Â 7) BIND ONCE
Â  Â ========================= */
let TR_BOUND = false;
function bindTranslateOnce(){
Â  if(TR_BOUND) return;
Â  TR_BOUND = true;
Â  btnTr?.addEventListener("click", doTranslate);
Â  btnSwapTr?.addEventListener("click", swapTranslate);
Â  btnApply?.addEventListener("click", applyToLyrics);
Â  // Enter to translate (Ctrl+Enter)
Â  trSrcEl?.addEventListener("keydown", (e)=>{
Â  Â  if((e.ctrlKey || e.metaKey) && e.key === "Enter"){
Â  Â  Â  doTranslate();
Â  Â  }
Â  });
Â  // Shortcut: Alt+T toggles mode
Â  document.addEventListener("keydown", (e)=>{
Â  Â  if(e.altKey && e.key.toLowerCase() === "t"){
Â  Â  Â  toggleTranslateMode();
Â  Â  }
Â  });
}
/* =========================
Â  Â 8) INIT
Â  Â ========================= */
(function initTranslate(){
Â  restoreTranslateState();
Â  bindTranslateOnce();
})();
/* =========================================================
Â  Â PART 6 â€” TRANSLATE ENGINE (Realistic)
Â  Â âœ… Mode A: Offline mini translate (no internet)
Â  Â âœ… Mode B: Online API translate (optional)
Â  Â âœ… Apply result into Lyrics EN/VI of current track
Â  Â âœ… Save last translate state
Â  Â ========================================================= */
/* =========================
Â  Â 0) DOM (Must match PART 5)
Â  Â ========================= */
const trSrcElÂ  Â = $("#trSrc");
const trOutElÂ  Â = $("#trOut");
const trDirElÂ  Â = $("#trDir");
const btnTrÂ  Â  Â = $("#btnTranslate");
const btnSwapTr = $("#btnSwapTr");
const btnApplyÂ  = $("#btnApplyToLyrics");
/* =========================
Â  Â 1) SETTINGS + STORAGE
Â  Â ========================= */
const TR = {
Â  LS_KEY: "MVAPP_TRANSLATE_STATE_V1",
Â  MODE: "offline", // "offline" | "api"
Â  // Náº¿u dÃ¹ng API: Ä‘iá»n endpoint á»Ÿ Ä‘Ã¢y
Â  // LibreTranslate example: https://libretranslate.com/translate
Â  // Self-hosted: https://your-domain.com/translate
Â  API_URL: "",
Â  // timeout fetch (ms)
Â  TIMEOUT: 12000
};
function restoreTranslateState(){
Â  const saved = safeJSONParse(localStorage.getItem(TR.LS_KEY), null);
Â  if(!saved) return;
Â  if(trSrcEl && typeof saved.src === "string") trSrcEl.value = saved.src;
Â  if(trOutEl && typeof saved.out === "string") trOutEl.value = saved.out;
Â  if(trDirEl && (saved.dir === "en2vi" || saved.dir === "vi2en")) trDirEl.value = saved.dir;
Â  if(typeof saved.mode === "string" && (saved.mode === "offline" || saved.mode === "api")) TR.MODE = saved.mode;
Â  if(typeof saved.apiUrl === "string") TR.API_URL = saved.apiUrl;
}
function saveTranslateState(){
Â  localStorage.setItem(TR.LS_KEY, JSON.stringify({
Â  Â  src: trSrcEl?.value || "",
Â  Â  out: trOutEl?.value || "",
Â  Â  dir: trDirEl?.value || "en2vi",
Â  Â  mode: TR.MODE,
Â  Â  apiUrl: TR.API_URL
Â  }));
}
/* =========================
Â  Â 2) MODE A â€” OFFLINE MINI TRANSLATE
Â  Â - KhÃ´ng thá»ƒ dá»‹ch chuáº©n 100% nhÆ° Google,
Â  Â  Â nhÆ°ng Ä‘á»§ cho cÃ¢u cÆ¡ báº£n + há»c tá»« vá»±ng.
Â  Â ========================= */
const MINI_DICT_EN2VI = {
Â  "hello":"xin chÃ o",
Â  "hi":"chÃ o",
Â  "good":"tá»‘t",
Â  "bad":"tá»‡",
Â  "morning":"buá»•i sÃ¡ng",
Â  "night":"buá»•i tá»‘i",
Â  "thank you":"cáº£m Æ¡n",
Â  "thanks":"cáº£m Æ¡n",
Â  "sorry":"xin lá»—i",
Â  "love":"yÃªu",
Â  "miss":"nhá»›",
Â  "you":"báº¡n",
Â  "i":"tÃ´i",
Â  "we":"chÃºng tÃ´i",
Â  "they":"há»",
Â  "he":"anh áº¥y",
Â  "she":"cÃ´ áº¥y",
Â  "music":"Ã¢m nháº¡c",
Â  "song":"bÃ i hÃ¡t",
Â  "lyrics":"lá»i bÃ i hÃ¡t",
Â  "today":"hÃ´m nay",
Â  "tomorrow":"ngÃ y mai",
Â  "yesterday":"hÃ´m qua",
Â  "happy":"vui",
Â  "sad":"buá»“n",
Â  "beautiful":"Ä‘áº¹p",
Â  "family":"gia Ä‘Ã¬nh",
Â  "friend":"báº¡n",
Â  "work":"cÃ´ng viá»‡c",
Â  "study":"há»c",
Â  "school":"trÆ°á»ng",
Â  "home":"nhÃ "
};
// VI->EN táº¡o ngÆ°á»£c nhanh
const MINI_DICT_VI2EN = Object.fromEntries(
Â  Object.entries(MINI_DICT_EN2VI).map(([en,vi]) => [vi,en])
);
function offlineTranslate(text, dir){
Â  const raw = (text || "").trim();
Â  if(!raw) return "";
Â  // Dá»‹ch theo cá»¥m trÆ°á»›c (phrase), rá»“i theo tá»«
Â  const dict = (dir === "en2vi") ? MINI_DICT_EN2VI : MINI_DICT_VI2EN;
Â  // 1) thay phrase dÃ i trÆ°á»›c
Â  let out = raw;
Â  const phrases = Object.keys(dict).sort((a,b)=> b.length - a.length);
Â  phrases.forEach(k=>{
Â  Â  const safe = k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
Â  Â  const rx = new RegExp(`\\b${safe}\\b`, "gi");
Â  Â  out = out.replace(rx, (m)=> {
Â  Â  Â  // giá»¯ hoa chá»¯ cÃ¡i Ä‘áº§u náº¿u cÃ³
Â  Â  Â  const rep = dict[k];
Â  Â  Â  if(!rep) return m;
Â  Â  Â  const isCap = m[0] === m[0].toUpperCase();
Â  Â  Â  return isCap ? rep.charAt(0).toUpperCase() + rep.slice(1) : rep;
Â  Â  });
Â  });
Â  return out;
}
/* =========================
Â  Â 3) MODE B â€” ONLINE API TRANSLATE
Â  Â - Anh cÃ³ thá»ƒ dÃ¹ng LibreTranslate/self-host.
Â  Â - Payload chuáº©n:
Â  Â  Â { q, source, target, format:"text" }
Â  Â ========================= */
function fetchWithTimeout(url, opts={}, timeout=12000){
Â  return new Promise((resolve, reject)=>{
Â  Â  const ctrl = new AbortController();
Â  Â  const id = setTimeout(()=> ctrl.abort(), timeout);
Â  Â  fetch(url, { ...opts, signal: ctrl.signal })
Â  Â  Â  .then(res => { clearTimeout(id); resolve(res); })
Â  Â  Â  .catch(err => { clearTimeout(id); reject(err); });
Â  });
}
async function apiTranslate(text, dir){
Â  if(!TR.API_URL){
Â  Â  throw new Error("Missing API URL");
Â  }
Â  const source = dir === "en2vi" ? "en" : "vi";
Â  const target = dir === "en2vi" ? "vi" : "en";
Â  const body = {
Â  Â  q: text,
Â  Â  source,
Â  Â  target,
Â  Â  format: "text"
Â  };
Â  const res = await fetchWithTimeout(TR.API_URL, {
Â  Â  method: "POST",
Â  Â  headers: { "Content-Type":"application/json" },
Â  Â  body: JSON.stringify(body)
Â  }, TR.TIMEOUT);
Â  if(!res.ok){
Â  Â  const t = await res.text().catch(()=> "");
Â  Â  throw new Error(`API error ${res.status}: ${t.slice(0,200)}`);
Â  }
Â  const data = await res.json();
Â  // LibreTranslate: { translatedText: "..." }
Â  const translated = data?.translatedText || data?.translation || data?.result;
Â  if(typeof translated !== "string") throw new Error("Bad API response");
Â  return translated;
}
/* =========================
Â  Â 4) MAIN TRANSLATE ACTION
Â  Â ========================= */
async function doTranslate(){
Â  const text = (trSrcEl?.value || "").trim();
Â  const dirÂ  = trDirEl?.value || "en2vi";
Â  if(!text){
Â  Â  toast("âš ï¸ Please enter text to translate");
Â  Â  return;
Â  }
Â  try{
Â  Â  toast("â³ Translating...");
Â  Â  let result = "";
Â  Â  if(TR.MODE === "api"){
Â  Â  Â  result = await apiTranslate(text, dir);
Â  Â  }else{
Â  Â  Â  result = offlineTranslate(text, dir);
Â  Â  }
Â  Â  if(trOutEl) trOutEl.value = result;
Â  Â  saveTranslateState();
Â  Â  toast("âœ… Done");
Â  }catch(e){
Â  Â  console.error(e);
Â  Â  toast("âŒ Translate failed (check MODE/API URL)");
Â  }
}
/* =========================
Â  Â 5) SWAP + APPLY TO LYRICS
Â  Â ========================= */
function swapTranslate(){
Â  const a = trSrcEl?.value || "";
Â  const b = trOutEl?.value || "";
Â  if(trSrcEl) trSrcEl.value = b;
Â  if(trOutEl) trOutEl.value = a;
Â  // swap direction
Â  const d = trDirEl?.value || "en2vi";
Â  if(trDirEl) trDirEl.value = (d === "en2vi") ? "vi2en" : "en2vi";
Â  saveTranslateState();
Â  toast("ğŸ” Swapped");
}
function applyToLyrics(){
Â  const dir = trDirEl?.value || "en2vi";
Â  const out = (trOutEl?.value || "").trim();
Â  const src = (trSrcEl?.value || "").trim();

Â  if(!out && !src){
Â  Â  toast("âš ï¸ Nothing to apply");
Â  Â  return;
Â  }
Â  // Náº¿u ENâ†’VI: src lÃ  EN, out lÃ  VI
Â  if(dir === "en2vi"){
Â  Â  if(lyricEnEl) lyricEnEl.value = src;
Â  Â  if(lyricViEl) lyricViEl.value = out;
Â  }else{
Â  Â  // VIâ†’EN: src lÃ  VI, out lÃ  EN
Â  Â  if(lyricViEl) lyricViEl.value = src;
Â  Â  if(lyricEnEl) lyricEnEl.value = out;
Â  }
Â  toast("âœ… Applied to Lyrics");
}
/* =========================
Â  Â 6) QUICK SETTINGS UI (Optional)
Â  Â - KhÃ´ng cáº§n HTML thÃªm.
Â  Â - DÃ¹ng phÃ­m táº¯t Ä‘á»ƒ Ä‘á»•i MODE.
Â  Â ========================= */
function toggleTranslateMode(){
Â  TR.MODE = (TR.MODE === "offline") ? "api" : "offline";
Â  saveTranslateState();
Â  toast(`ğŸŒ Translate mode: ${TR.MODE.toUpperCase()}`);
Â  if(TR.MODE === "api" && !TR.API_URL){
Â  Â  toast("â„¹ï¸ API mode ON but API_URL is empty");
Â  }
}
/* =========================
Â  Â 7) BIND ONCE
Â  Â ========================= */
let TR_BOUND = false;
function bindTranslateOnce(){
Â  if(TR_BOUND) return;
Â  TR_BOUND = true;
Â  btnTr?.addEventListener("click", doTranslate);
Â  btnSwapTr?.addEventListener("click", swapTranslate);
Â  btnApply?.addEventListener("click", applyToLyrics);
Â  // Enter to translate (Ctrl+Enter)
Â  trSrcEl?.addEventListener("keydown", (e)=>{
Â  Â  if((e.ctrlKey || e.metaKey) && e.key === "Enter"){
Â  Â  Â  doTranslate();
Â  Â  }
Â  });
Â  // Shortcut: Alt+T toggles mode
Â  document.addEventListener("keydown", (e)=>{
Â  Â  if(e.altKey && e.key.toLowerCase() === "t"){
Â  Â  Â  toggleTranslateMode();
Â  Â  }
Â  });
}
/* =========================
Â  Â 8) INIT
Â  Â ========================= */
(function initTranslate(){
Â  restoreTranslateState();
Â  bindTranslateOnce();
})();
/* =========================================================
Â  Â PART 8 â€” AUTO LYRICS TRANSLATE (LINE-BY-LINE) + SAVE/IMPORT/EXPORT
Â  Â âœ… Translate lyrics EN <-> VI like GG (uses PART 7 API) + offline fallback
Â  Â âœ… Per-track save into localStorage (compatible with PART 3 LS.lyrics)
Â  Â âœ… Translate by line (keeps line breaks), preserves empty lines
Â  Â âœ… Buttons:
Â  Â  Â  - #btnLyricAutoENtoVIÂ  : auto translate EN -> VI
Â  Â  Â  - #btnLyricAutoVItoENÂ  : auto translate VI -> EN
Â  Â  Â  - #btnLyricSaveBothÂ  Â  : save current EN+VI for current track
Â  Â  Â  - #btnLyricExportJSONÂ  : export all lyrics store (download .json)
Â  Â  Â  - #btnLyricImportJSONÂ  : import lyrics store from .json file input
Â  Â  Â  - #fileLyricImportÂ  Â  Â : <input type="file" accept="application/json">
Â  Â âœ… Works with PART 3 elements:
Â  Â  Â  - #lyricEN, #lyricVI and TRACKS/state/LS from PART 3
Â  Â ========================================================= */

(function(){
Â  // ---------------------------------------------------------
Â  // 0) Guards / Helpers
Â  // ---------------------------------------------------------
Â  const $Â  = (q, root=document) => root.querySelector(q);
Â  const $$ = (q, root=document) => Array.from(root.querySelectorAll(q));

Â  // Try reuse toast from PART 3
Â  const toast = window.toast || function(msg){ alert(msg); };

Â  function safeJSONParse(str, fallback){
Â  Â  try{ return JSON.parse(str); }catch(e){ return fallback; }
Â  }
Â  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

Â  // ---------------------------------------------------------
Â  // 1) Required globals from PART 3
Â  // ---------------------------------------------------------
Â  // TRACKS: [{id,title,artist,tag,...}] and state.idx and LS.lyrics key
Â  // If your playlist array is named MEDIA, create TRACKS mapping in PART 3.
Â  const TRACKS = window.TRACKS || window.MEDIA || [];
Â  const stateÂ  = window.stateÂ  || { idx:0 };
Â  const LSÂ  Â  Â = window.LSÂ  Â  Â || { lyrics:"MVAPP_LYRICS_V1" };

Â  // If MEDIA uses {videoId}, adapt to {id}
Â  // We'll create a normalized accessor for "track id"
Â  function trackId(t){
Â  Â  return t?.id || t?.videoId || "unknown";
Â  }

Â  // ---------------------------------------------------------
Â  // 2) DOM
Â  // ---------------------------------------------------------
Â  const lyricEnEl = $("#lyricEN");
Â  const lyricViEl = $("#lyricVI");

Â  const btnENtoVI = $("#btnLyricAutoENtoVI");
Â  const btnVItoEN = $("#btnLyricAutoVItoEN");
Â  const btnSaveÂ  Â = $("#btnLyricSaveBoth");
Â  const btnExport = $("#btnLyricExportJSON");
Â  const btnImport = $("#btnLyricImportJSON");
Â  const fileInput = $("#fileLyricImport");

Â  // Optional status
Â  const progElÂ  Â  = $("#lyricProgress"); // <span id="lyricProgress"></span> (optional)

Â  // ---------------------------------------------------------
Â  // 3) Read/Write lyrics store (same style as PART 3)
Â  // ---------------------------------------------------------
Â  function readLyricsStore(){
Â  Â  return safeJSONParse(localStorage.getItem(LS.lyrics), {});
Â  }
Â  function writeLyricsStore(obj){
Â  Â  localStorage.setItem(LS.lyrics, JSON.stringify(obj));
Â  }
Â  function currentTrack(){
Â  Â  if(!TRACKS.length) return null;
Â  Â  const idx = clamp(state.idx||0, 0, TRACKS.length-1);
Â  Â  return TRACKS[idx];
Â  }
Â  function loadLyricsForCurrentIntoUI(showToast=false){
Â  Â  const t = currentTrack();
Â  Â  if(!t) return;
Â  Â  const store = readLyricsStore();
Â  Â  const key = trackId(t);
Â  Â  const data = store[key];
Â  Â  if(lyricEnEl) lyricEnEl.value = data?.en || "";
Â  Â  if(lyricViEl) lyricViEl.value = data?.vi || "";
Â  Â  if(showToast) toast(data ? "ğŸ“¥ Loaded lyrics" : "â„¹ï¸ No saved lyrics");
Â  }
Â  function saveBothLyricsForCurrent(){
Â  Â  const t = currentTrack();
Â  Â  if(!t) return;
Â  Â  const store = readLyricsStore();
Â  Â  const key = trackId(t);
Â  Â  store[key] = {
Â  Â  Â  title: t.title || "",
Â  Â  Â  artist: t.artist || t.meta || "",
Â  Â  Â  en: (lyricEnEl?.value || "").trim(),
Â  Â  Â  vi: (lyricViEl?.value || "").trim(),
Â  Â  Â  updatedAt: Date.now()
Â  Â  };
Â  Â  writeLyricsStore(store);
Â  Â  toast("âœ… Saved EN+VI lyrics");
Â  }
Â  // ---------------------------------------------------------
Â  // 4) Translate core (uses PART 7: TR.MODE + apiTranslate/offline)
Â  // ---------------------------------------------------------
Â  // From PART 7:
Â  //Â  Â window.TR.MODE = "api"|"offline"
Â  //Â  Â apiTranslate(text, source, target)Â  (we can call if exists)
Â  //Â  Â offlineTranslate(text, source, target) (fallback)
Â  const TR = window.TR || (window.TR = {});
Â  const apiTranslate = window.apiTranslate;
Â  const offlineTranslate = window.offlineTranslate;
Â  function detectLangSimple(text){
Â  Â  const s = (text||"").toString();
Â  Â  const vi = /[Ã Ã¡áº¡áº£Ã£Ã¢áº§áº¥áº­áº©áº«Äƒáº±áº¯áº·áº³áºµÃ¨Ã©áº¹áº»áº½Ãªá»áº¿á»‡á»ƒá»…Ã¬Ã­á»‹á»‰Ä©Ã²Ã³á»á»ÃµÃ´á»“á»‘á»™á»•á»—Æ¡á»á»›á»£á»Ÿá»¡Ã¹Ãºá»¥á»§Å©Æ°á»«á»©á»±á»­á»¯á»³Ã½á»µá»·á»¹Ä‘]/i;
Â  Â  return vi.test(s) ? "vi" : "en";
Â  }
Â  // translate by line with batching to avoid huge requests
Â  // - keeps empty lines
Â  // - preserves line breaks exactly
Â  function splitLinesKeepEmpty(text){
Â  Â  // Keep Windows/Unix line endings normalized to \n
Â  Â  return (text || "").replace(/\r\n/g, "\n").split("\n");
Â  }
Â  // Join lines
Â  function joinLines(lines){
Â  Â  return lines.join("\n");
Â  }
Â  // Batch strategy:
Â  // - For API: send chunks of N lines joined by \n (to keep formatting)
Â  // - If chunk too long, reduce N
Â  const MAX_CHUNK_CHARS = 3500; // safe-ish for Apps Script + LanguageApp
Â  function batchLines(lines){
Â  Â  const batches = [];
Â  Â  let buf = [];
Â  Â  let len = 0;
Â  Â  for(const line of lines){
Â  Â  Â  const addLen = line.length + 1; // + newline
Â  Â  Â  if(buf.length > 0 && (len + addLen) > MAX_CHUNK_CHARS){
Â  Â  Â  Â  batches.push(buf);
Â  Â  Â  Â  buf = [];
Â  Â  Â  Â  len = 0;
Â  Â  Â  }
Â  Â  Â  buf.push(line);
Â  Â  Â  len += addLen;
Â  Â  }
Â  Â  if(buf.length) batches.push(buf);
Â  Â  return batches;
Â  }
Â  function setProgress(text){
Â  Â  if(progEl) progEl.textContent = text;
Â  }
Â  async function translateLyricsLineByLine(inputText, source, target){
Â  Â  const lines = splitLinesKeepEmpty(inputText);
Â  Â  if(lines.length === 0) return "";

Â  Â  // Fast path: empty
Â  Â  if(lines.every(l => !l.trim())) return inputText;

Â  Â  const batches = batchLines(lines);
Â  Â  const outLines = [];
Â  Â  let doneBatches = 0;
Â  Â  for(const batch of batches){
Â  Â  Â  doneBatches++;
Â  Â  Â  setProgress(`Translating ${doneBatches}/${batches.length}...`);

Â  Â  Â  const chunkText = joinLines(batch);

Â  Â  Â  let translatedChunk = "";
Â  Â  Â  if(TR.MODE === "api" && typeof apiTranslate === "function"){
Â  Â  Â  Â  translatedChunk = await apiTranslate(chunkText, source, target);
Â  Â  Â  }else if(typeof offlineTranslate === "function"){
Â  Â  Â  Â  // offline translate by words, but keep line breaks
Â  Â  Â  Â  translatedChunk = offlineTranslate(chunkText, source === "auto" ? detectLangSimple(chunkText) : source, target);
Â  Â  Â  }else{
Â  Â  Â  Â  throw new Error("No translate engine (PART 7 missing)");
Â  Â  Â  }
Â  Â  Â  // Because we kept \n, we can split back into same number of lines
Â  Â  Â  const tLines = splitLinesKeepEmpty(translatedChunk);

Â  Â  Â  // If the translator changes line count, fallback: keep original line structure
Â  Â  Â  if(tLines.length !== batch.length){
Â  Â  Â  Â  // map line-by-line: if counts mismatch, best effort align
Â  Â  Â  Â  for(let i=0;i<batch.length;i++){
Â  Â  Â  Â  Â  outLines.push(tLines[i] ?? "");
Â  Â  Â  Â  }
Â  Â  Â  }else{
Â  Â  Â  Â  outLines.push(...tLines);
Â  Â  Â  }
Â  Â  }
Â  Â  setProgress("");
Â  Â  return joinLines(outLines);
Â  }
Â  // ---------------------------------------------------------
Â  // 5) UI actions
Â  // ---------------------------------------------------------
Â  async function autoENtoVI(){
Â  Â  if(!lyricEnEl || !lyricViEl) return toast("âŒ Missing #lyricEN or #lyricVI");
Â  Â  const src = (lyricEnEl.value || "").trim();
Â  Â  if(!src) return toast("Nháº­p lyrics EN trÆ°á»›c Ä‘Ã£ anh");
Â  Â  disableButtons(true);
Â  Â  try{
Â  Â  Â  const out = await translateLyricsLineByLine(src, "en", "vi");
Â  Â  Â  lyricViEl.value = out;
Â  Â  Â  toast("âœ… Auto translated: EN â†’ VI");
Â  Â  }catch(e){
Â  Â  Â  toast("âŒ Translate failed (check PART 7 API_URL)");
Â  Â  }finally{
Â  Â  Â  disableButtons(false);
Â  Â  Â  setProgress("");
Â  Â  }
Â  }
Â  async function autoVItoEN(){
Â  Â  if(!lyricEnEl || !lyricViEl) return toast("âŒ Missing #lyricEN or #lyricVI");
Â  Â  const src = (lyricViEl.value || "").trim();
Â  Â  if(!src) return toast("Nháº­p lyrics VI trÆ°á»›c Ä‘Ã£ anh");
Â  Â  disableButtons(true);
Â  Â  try{
Â  Â  Â  const out = await translateLyricsLineByLine(src, "vi", "en");
Â  Â  Â  lyricEnEl.value = out;
Â  Â  Â  toast("âœ… Auto translated: VI â†’ EN");
Â  Â  }catch(e){
Â  Â  Â  toast("âŒ Translate failed (check PART 7 API_URL)");
Â  Â  }finally{
Â  Â  Â  disableButtons(false);
Â  Â  Â  setProgress("");
Â  Â  }
Â  }
Â  function disableButtons(disabled){
Â  Â  [btnENtoVI, btnVItoEN, btnSave, btnExport, btnImport].forEach(b=>{
Â  Â  Â  if(!b) return;
Â  Â  Â  b.disabled = !!disabled;
Â  Â  Â  b.classList.toggle("disabled", !!disabled);
Â  Â  });
Â  }
Â  function exportLyricsJSON(){
Â  Â  const store = readLyricsStore();
Â  Â  const blob = new Blob([JSON.stringify(store, null, 2)], { type:"application/json" });
Â  Â  const url = URL.createObjectURL(blob);
Â  Â  const a = document.createElement("a");
Â  Â  a.href = url;
Â  Â  a.download = "mvapp_lyrics_store.json";
Â  Â  document.body.appendChild(a);
Â  Â  a.click();
Â  Â  a.remove();
Â  Â  URL.revokeObjectURL(url);
Â  Â  toast("â¬‡ï¸ Exported lyrics JSON");
Â  }
Â  function importLyricsJSONFile(file){
Â  Â  return new Promise((resolve, reject)=>{
Â  Â  Â  const reader = new FileReader();
Â  Â  Â  reader.onload = ()=>{
Â  Â  Â  Â  try{
Â  Â  Â  Â  Â  const data = safeJSONParse(reader.result, null);
Â  Â  Â  Â  Â  if(!data || typeof data !== "object") throw new Error("Invalid JSON");
Â  Â  Â  Â  Â  // merge
Â  Â  Â  Â  Â  const store = readLyricsStore();
Â  Â  Â  Â  Â  const merged = { ...store, ...data };
Â  Â  Â  Â  Â  writeLyricsStore(merged);
Â  Â  Â  Â  Â  loadLyricsForCurrentIntoUI(true);
Â  Â  Â  Â  Â  toast("âœ… Imported lyrics JSON");
Â  Â  Â  Â  Â  resolve(true);
Â  Â  Â  Â  }catch(e){
Â  Â  Â  Â  Â  toast("âŒ Import failed: invalid JSON");
Â  Â  Â  Â  Â  reject(e);
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â  reader.onerror = ()=> reject(new Error("read error"));
Â  Â  Â  reader.readAsText(file);
Â  Â  });
Â  }
Â  // ---------------------------------------------------------
Â  // 6) Bind events
Â  // ---------------------------------------------------------
Â  let BOUND8 = false;
Â  function bindPart8Once(){
Â  Â  if(BOUND8) return;
Â  Â  BOUND8 = true;
Â  Â  btnENtoVI?.addEventListener("click", autoENtoVI);
Â  Â  btnVItoEN?.addEventListener("click", autoVItoEN);
Â  Â  btnSave?.addEventListener("click", saveBothLyricsForCurrent);
Â  Â  btnExport?.addEventListener("click", exportLyricsJSON);
Â  Â  btnImport?.addEventListener("click", ()=>{
Â  Â  Â  if(!fileInput) return toast("âŒ Missing #fileLyricImport input");
Â  Â  Â  fileInput.click();
Â  Â  });
Â  Â  fileInput?.addEventListener("change", async ()=>{
Â  Â  Â  const f = fileInput.files && fileInput.files[0];
Â  Â  Â  if(!f) return;
Â  Â  Â  await importLyricsJSONFile(f).catch(()=>{});
Â  Â  Â  fileInput.value = ""; // reset
Â  Â  });
Â  Â  // Optional: auto-load when track changes (if PART 3 calls loadLyricsForCurrent)
Â  Â  // Here we just load once at init
Â  Â  loadLyricsForCurrentIntoUI(false);
Â  }
Â  // ---------------------------------------------------------
Â  // 7) Init
Â  // ---------------------------------------------------------
Â  if(document.readyState === "loading"){
Â  Â  document.addEventListener("DOMContentLoaded", bindPart8Once, { once:true });
Â  }else{
Â  Â  bindPart8Once();
Â  }
})();
/* =========================================================
Â  Â PART 9 â€” SMART PLAYLIST ENGINE (100 TRACKS) + NO-DUPES + CATEGORIES + TRENDING FETCH (OPTIONAL)
Â  Â âœ… Fixes your PART 3 issues:
Â  Â  Â  - TRACKS variable missing (you used MEDIA + TRACKS mixed)
Â  Â  Â  - duplicates videoId entries
Â  Â  Â  - ensures EXACT 100 tracks for player
Â  Â âœ… Features:
Â  Â  Â  - Build TRACKS from MEDIA (normalize fields)
Â  Â  Â  - Remove duplicates by id (videoId) + title fallback
Â  Â  Â  - Ensure at least 100 (pad with safe placeholders if thiáº¿u)
Â  Â  Â  - Categories (US/UK, K-POP, LATIN, EDM, CLASSIC, GLOBAL)
Â  Â  Â  - Random "Trending-like" shuffle pool (offline mode)
Â  Â  Â  - Optional: fetch trending list from your backend (if you have API)
Â  Â ========================================================= */

(function(){
Â  const toast = window.toast || function(m){ console.log(m); };

Â  // ---------------------------------------------------------
Â  // 0) SOURCE: MEDIA list from PART 3
Â  // ---------------------------------------------------------
Â  const MEDIA = window.MEDIA || [];
Â  // Optional: if you already had TRACKS, we'll rebuild anyway for clean
Â  // window.TRACKS will be overwritten.

Â  // ---------------------------------------------------------
Â  // 1) Helpers
Â  // ---------------------------------------------------------
Â  const norm = (s)=> (s||"").toString().trim().toLowerCase();
Â  function uniqBy(arr, keyFn){
Â  Â  const seen = new Set();
Â  Â  const out = [];
Â  Â  for(const x of arr){
Â  Â  Â  const k = keyFn(x);
Â  Â  Â  if(!k) continue;
Â  Â  Â  if(seen.has(k)) continue;
Â  Â  Â  seen.add(k);
Â  Â  Â  out.push(x);
Â  Â  }
Â  Â  return out;
Â  }
Â  function pickTag(item){
Â  Â  // Prefer meta from your list: "US/UK", "K-POP", etc.
Â  Â  if(item.tag) return item.tag;
Â  Â  if(item.meta) return item.meta;
Â  Â  if(item.type && item.type !== "MUSIC") return item.type;
Â  Â  return "TRACK";
Â  }
Â  function toTrack(item, idx){
Â  Â  // Normalize both styles:
Â  Â  // - old: {videoId,title,meta,desc}
Â  Â  // - new: {id,title,artist,tag,note,start}
Â  Â  const id = item.id || item.videoId || item.yt || item.youtubeId || "";
Â  Â  return {
Â  Â  Â  id,
Â  Â  Â  title: item.title || `Track ${idx+1}`,
Â  Â  Â  artist: item.artist || "",
Â  Â  Â  tag: pickTag(item),
Â  Â  Â  note: item.note || item.desc || "",
Â  Â  Â  start: Number.isFinite(item.start) ? item.start : 0
Â  Â  };
Â  }
Â  // ---------------------------------------------------------
Â  // 2) Build TRACKS + remove duplicates
Â  // ---------------------------------------------------------
Â  let tracks = MEDIA.map((m,i)=> toTrack(m,i)).filter(t=> !!t.id);
Â  // remove dupes by id
Â  tracks = uniqBy(tracks, t=> t.id);
Â  // second pass: if still duplicates by title (rare), keep first
Â  tracks = uniqBy(tracks, t=> `${t.id}|${norm(t.title)}`);
Â  // ---------------------------------------------------------
Â  // 3) Ensure EXACT 100 tracks
Â  // ---------------------------------------------------------
Â  const TARGET = 100;
Â  // If more than 100, slice but keep category diversity:
Â  // We'll keep a balanced take from each tag.
Â  function balancedSlice(list, n){
Â  Â  if(list.length <= n) return list.slice();
Â  Â  const groups = {};
Â  Â  for(const t of list){
Â  Â  Â  const g = t.tag || "TRACK";
Â  Â  Â  (groups[g] ||= []).push(t);
Â  Â  }
Â  Â  const tags = Object.keys(groups);
Â  Â  // round-robin pick
Â  Â  const out = [];
Â  Â  let k = 0;
Â  Â  while(out.length < n){
Â  Â  Â  const tag = tags[k % tags.length];
Â  Â  Â  const g = groups[tag];
Â  Â  Â  if(g && g.length) out.push(g.shift());
Â  Â  Â  // stop if all empty
Â  Â  Â  if(tags.every(tt => !(groups[tt] && groups[tt].length))) break;
Â  Â  Â  k++;
Â  Â  }
Â  Â  // if still short, fill from any remaining
Â  Â  if(out.length < n){
Â  Â  Â  const remain = Object.values(groups).flat();
Â  Â  Â  out.push(...remain.slice(0, n - out.length));
Â  Â  }
Â  Â  return out.slice(0, n);
Â  }
Â  if(tracks.length > TARGET){
Â  Â  tracks = balancedSlice(tracks, TARGET);
Â  }
Â  // If less than 100, pad with safe placeholders (so player won't crash)
Â  // You MUST replace these later with real videoIds.
Â  function padPlaceholders(list, n){
Â  Â  const out = list.slice();
Â  Â  let i = out.length;
Â  Â  while(out.length < n){
Â  Â  Â  // Rickroll as safe always-available video; but we avoid duplicates:
Â  Â  Â  // create fake ids (won't play) is bad -> better use real fallback IDs.
Â  Â  Â  // We'll use a small set of reliable public domain/creative commons music IDs (still may change),
Â  Â  Â  // so for now we repeat a "fallback pool" but mark as placeholder.
Â  Â  Â  const fallbackPool = [
Â  Â  Â  Â  "dQw4w9WgXcQ", // fallback 1
Â  Â  Â  Â  "Zi_XLOBDo_Y", // MJ Billie Jean
Â  Â  Â  Â  "OPf0YbXqDm0",Â  // Uptown Funk
Â  Â  Â  Â  "9bZkp7q19f0"Â  Â // Gangnam Style
Â  Â  Â  ];
Â  Â  Â  const vid = fallbackPool[(i - list.length) % fallbackPool.length];
Â  Â  Â  // Ensure no duplicate id: if already exists, create "alt" by skipping
Â  Â  Â  let id = vid;
Â  Â  Â  let guard = 0;
Â  Â  Â  while(out.some(t=>t.id===id) && guard < 10){
Â  Â  Â  Â  guard++;
Â  Â  Â  Â  id = fallbackPool[(i - list.length + guard) % fallbackPool.length];
Â  Â  Â  }
Â  Â  Â  // If still duplicate, break to avoid infinite loop
Â  Â  Â  if(out.some(t=>t.id===id)) break;
Â  Â  Â  out.push({
Â  Â  Â  Â  id,
Â  Â  Â  Â  title: `PLACEHOLDER Track ${out.length+1} (replace me)`,
Â  Â  Â  Â  artist: "",
Â  Â  Â  Â  tag: "PLACEHOLDER",
Â  Â  Â  Â  note: "Thiáº¿u track tháº­t â€” hÃ£y thay báº±ng videoId há»£p lá»‡.",
Â  Â  Â  Â  start: 0
Â  Â  Â  });
Â  Â  Â  i++;
Â  Â  }
Â  Â  return out;
Â  }
Â  if(tracks.length < TARGET){
Â  Â  tracks = padPlaceholders(tracks, TARGET);
Â  }
Â  // Final: ensure exactly 100
Â  tracks = tracks.slice(0, TARGET);
Â  // ---------------------------------------------------------
Â  // 4) Expose TRACKS + category index
Â  // ---------------------------------------------------------
Â  window.TRACKS = tracks;
Â  window.TRACK_CATEGORIES = tracks.reduce((acc,t)=>{
Â  Â  const g = t.tag || "TRACK";
Â  Â  (acc[g] ||= []).push(t);
Â  Â  return acc;
Â  }, {});
Â  // ---------------------------------------------------------
Â  // 5) Optional "Trending fetch" (if you have an API)
Â  // ---------------------------------------------------------
Â  // If you build your own backend, you can fetch a trending list and replace TRACKS.
Â  // Example API returns: [{id,title,artist,tag,note,start}, ...]
Â  // Turn on by setting: window.TREND_API_URL = "https://...."
Â  async function tryFetchTrending(){
Â  Â  const url = window.TREND_API_URL;
Â  Â  if(!url) return false;
Â  Â  try{
Â  Â  Â  const r = await fetch(url, { cache:"no-store" });
Â  Â  Â  if(!r.ok) throw new Error("bad status");
Â  Â  Â  const data = await r.json();
Â  Â  Â  if(!Array.isArray(data)) throw new Error("bad json");
Â  Â  Â  let t2 = data.map((x,i)=> ({
Â  Â  Â  Â  id: x.id || x.videoId || "",
Â  Â  Â  Â  title: x.title || `Track ${i+1}`,
Â  Â  Â  Â  artist: x.artist || "",
Â  Â  Â  Â  tag: x.tag || x.meta || "TREND",
Â  Â  Â  Â  note: x.note || "",
Â  Â  Â  Â  start: Number.isFinite(x.start) ? x.start : 0
Â  Â  Â  })).filter(x=>!!x.id);
Â  Â  Â  t2 = uniqBy(t2, x=>x.id);
Â  Â  Â  if(t2.length >= 10){
Â  Â  Â  Â  // keep 100 max
Â  Â  Â  Â  window.TRACKS = balancedSlice(t2, TARGET);
Â  Â  Â  Â  toast("ğŸ”¥ Trending tracks loaded!");
Â  Â  Â  Â  return true;
Â  Â  Â  }
Â  Â  Â  return false;
Â  Â  }catch(e){
Â  Â  Â  toast("âš ï¸ TREND fetch failed, using offline TRACKS");
Â  Â  Â  return false;
Â  Â  }
Â  }

Â  // ---------------------------------------------------------
Â  // 6) Integration tip for PART 3
Â  // ---------------------------------------------------------
Â  // IMPORTANT:
Â  // In PART 3 you must use TRACKS (not MEDIA) everywhere.
Â  // After Part 9 runs, TRACKS is guaranteed size 100 and no dupes.
Â  //
Â  // So you can call:
Â  //Â  Â window.initMediaPlayer?.()
Â  // If init already ran, just rerender playlist and reload current.
Â  function refreshPlayerIfExists(){
Â  Â  try{
Â  Â  Â  // If PART 3 functions exist:
Â  Â  Â  if(typeof window.renderPlaylist === "function") window.renderPlaylist();
Â  Â  Â  if(typeof window.loadTrack === "function") window.loadTrack(state.idx || 0, { useSavedTime:true });
Â  Â  }catch(e){}
Â  }
Â  // Try trending fetch, then refresh player
Â  (async ()=>{
Â  Â  await tryFetchTrending();
Â  Â  refreshPlayerIfExists();
Â  Â  toast(`âœ… PART 9 ready: TRACKS=${window.TRACKS.length} (no-dup)`);
Â  })();
})();
/* =========================================================
Â  Â PART 10 â€” GREAT QUOTES ENGINE (100 ENâ€“VI)
Â  Â âœ… 100 famous quotes (English + Vietnamese)
Â  Â âœ… Random quote
Â  Â âœ… Daily quote
Â  Â âœ… Copy / Save
Â  Â ========================================================= */
Â (function(){
Â  const $ = (q,root=document)=>root.querySelector(q);
Â  const toast = window.toast || (m=>alert(m));
Â  /* =========================
Â  Â  Â 1) QUOTES DATA (100)
Â  Â  Â ========================= */
Â  const QUOTES = [
Â  Â  {en:"Imagination is more important than knowledge.",vi:"TrÃ­ tÆ°á»Ÿng tÆ°á»£ng quan trá»ng hÆ¡n kiáº¿n thá»©c.",author:"Albert Einstein"},
Â  Â  {en:"Life is like riding a bicycle. To keep your balance, you must keep moving.",vi:"Cuá»™c sá»‘ng giá»‘ng nhÆ° Ä‘i xe Ä‘áº¡p, muá»‘n giá»¯ thÄƒng báº±ng báº¡n pháº£i tiáº¿p tá»¥c tiáº¿n lÃªn.",author:"Albert Einstein"},
Â  Â  {en:"Success is not final, failure is not fatal.",vi:"ThÃ nh cÃ´ng khÃ´ng pháº£i lÃ  vÄ©nh viá»…n, tháº¥t báº¡i khÃ´ng pháº£i lÃ  káº¿t thÃºc.",author:"Winston Churchill"},
Â  Â  {en:"Never, never, never give up.",vi:"Äá»«ng bao giá», Ä‘á»«ng bao giá» bá» cuá»™c.",author:"Winston Churchill"},
Â  Â  {en:"Stay hungry, stay foolish.",vi:"HÃ£y khÃ¡t khao, hÃ£y dáº¡i khá».",author:"Steve Jobs"},
Â  Â  {en:"Your time is limited, donâ€™t waste it.",vi:"Thá»i gian cá»§a báº¡n cÃ³ háº¡n, Ä‘á»«ng lÃ£ng phÃ­ nÃ³.",author:"Steve Jobs"},
Â  Â  {en:"Whether you think you can or you think you canâ€™t, youâ€™re right.",vi:"Báº¡n nghÄ© mÃ¬nh lÃ m Ä‘Æ°á»£c hay khÃ´ng, báº¡n Ä‘á»u Ä‘Ãºng.",author:"Henry Ford"},
Â  Â  {en:"Failure is simply the opportunity to begin again.",vi:"Tháº¥t báº¡i chá»‰ lÃ  cÆ¡ há»™i Ä‘á»ƒ báº¯t Ä‘áº§u láº¡i.",author:"Henry Ford"},
Â  Â  {en:"It always seems impossible until itâ€™s done.",vi:"Má»i thá»© luÃ´n cÃ³ váº» khÃ´ng thá»ƒ cho Ä‘áº¿n khi hoÃ n thÃ nh.",author:"Nelson Mandela"},
Â  Â  {en:"Education is the most powerful weapon to change the world.",vi:"GiÃ¡o dá»¥c lÃ  vÅ© khÃ­ máº¡nh nháº¥t Ä‘á»ƒ thay Ä‘á»•i tháº¿ giá»›i.",author:"Nelson Mandela"},
Â  Â  {en:"Be the change you wish to see in the world.",vi:"HÃ£y lÃ  sá»± thay Ä‘á»•i báº¡n muá»‘n tháº¥y trÃªn tháº¿ giá»›i.",author:"Mahatma Gandhi"},
Â  Â  {en:"Happiness depends upon ourselves.",vi:"Háº¡nh phÃºc phá»¥ thuá»™c vÃ o chÃ­nh chÃºng ta.",author:"Aristotle"},
Â  Â  {en:"Knowing yourself is the beginning of all wisdom.",vi:"Biáº¿t mÃ¬nh lÃ  khá»Ÿi Ä‘áº§u cá»§a má»i trÃ­ tuá»‡.",author:"Aristotle"},
Â  Â  {en:"An unexamined life is not worth living.",vi:"Cuá»™c Ä‘á»i khÃ´ng suy ngáº«m lÃ  cuá»™c Ä‘á»i khÃ´ng Ä‘Ã¡ng sá»‘ng.",author:"Socrates"},
Â  Â  {en:"The only true wisdom is in knowing you know nothing.",vi:"TrÃ­ tuá»‡ thá»±c sá»± lÃ  biáº¿t ráº±ng báº¡n khÃ´ng biáº¿t gÃ¬.",author:"Socrates"},
Â  Â  {en:"The secret of getting ahead is getting started.",vi:"BÃ­ quyáº¿t Ä‘á»ƒ tiáº¿n lÃªn lÃ  báº¯t Ä‘áº§u.",author:"Mark Twain"},
Â  Â  {en:"If you donâ€™t read the newspaper, youâ€™re uninformed.",vi:"KhÃ´ng Ä‘á»c bÃ¡o lÃ  khÃ´ng biáº¿t gÃ¬.",author:"Mark Twain"},
Â  Â  {en:"An investment in knowledge pays the best interest.",vi:"Äáº§u tÆ° vÃ o tri thá»©c mang láº¡i lá»£i nhuáº­n tá»‘t nháº¥t.",author:"Benjamin Franklin"},
Â  Â  {en:"Tell me and I forget. Teach me and I remember.",vi:"NÃ³i tÃ´i quÃªn, dáº¡y tÃ´i nhá»›.",author:"Benjamin Franklin"},
Â  Â  {en:"The future belongs to those who believe in their dreams.",vi:"TÆ°Æ¡ng lai thuá»™c vá» nhá»¯ng ai tin vÃ o Æ°á»›c mÆ¡.",author:"Eleanor Roosevelt"},
Â  Â  {en:"Believe you can and youâ€™re halfway there.",vi:"Tin lÃ  báº¡n Ä‘Ã£ Ä‘i Ä‘Æ°á»£c ná»­a cháº·ng Ä‘Æ°á»ng.",author:"Theodore Roosevelt"},
Â  Â  {en:"Do what you can, with what you have, where you are.",vi:"HÃ£y lÃ m nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ vá»›i nhá»¯ng gÃ¬ báº¡n cÃ³.",author:"Theodore Roosevelt"},
Â  Â  {en:"Dream big and dare to fail.",vi:"HÃ£y mÆ¡ lá»›n vÃ  dÃ¡m tháº¥t báº¡i.",author:"Norman Vaughan"},
Â  Â  {en:"Donâ€™t count the days, make the days count.",vi:"Äá»«ng Ä‘áº¿m ngÃ y, hÃ£y lÃ m cho ngÃ y Ä‘Ã¡ng giÃ¡.",author:"Muhammad Ali"},
Â  Â  {en:"He who has a why can endure any how.",vi:"Ai cÃ³ lÃ½ do sá»‘ng cÃ³ thá»ƒ chá»‹u Ä‘á»±ng má»i cÃ¡ch sá»‘ng.",author:"Friedrich Nietzsche"},
Â  Â  {en:"That which does not kill us makes us stronger.",vi:"Äiá»u khÃ´ng giáº¿t cháº¿t ta khiáº¿n ta máº¡nh máº½ hÆ¡n.",author:"Friedrich Nietzsche"},
Â  Â  {en:"Act as if what you do makes a difference. It does.",vi:"HÃ£y hÃ nh Ä‘á»™ng nhÆ° thá»ƒ viá»‡c báº¡n lÃ m táº¡o ra khÃ¡c biá»‡t.",author:"William James"},
Â  Â  {en:"The best way to predict the future is to create it.",vi:"CÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ dá»± Ä‘oÃ¡n tÆ°Æ¡ng lai lÃ  táº¡o ra nÃ³.",author:"Peter Drucker"},
Â  Â  {en:"Success usually comes to those who are too busy to look for it.",vi:"ThÃ nh cÃ´ng Ä‘áº¿n vá»›i nhá»¯ng ngÆ°á»i quÃ¡ báº­n rá»™n Ä‘á»ƒ tÃ¬m nÃ³.",author:"Henry David Thoreau"},
Â  Â  {en:"Go confidently in the direction of your dreams.",vi:"HÃ£y tá»± tin Ä‘i theo hÆ°á»›ng Æ°á»›c mÆ¡.",author:"Henry David Thoreau"},
Â  Â  {en:"Life is either a daring adventure or nothing.",vi:"Cuá»™c sá»‘ng hoáº·c lÃ  má»™t cuá»™c phiÃªu lÆ°u tÃ¡o báº¡o hoáº·c cháº³ng lÃ  gÃ¬.",author:"Helen Keller"},
Â  Â  {en:"Alone we can do so little; together we can do so much.",vi:"Má»™t mÃ¬nh ta lÃ m Ä‘Æ°á»£c Ã­t, cÃ¹ng nhau ta lÃ m Ä‘Æ°á»£c nhiá»u.",author:"Helen Keller"},
Â  Â  {en:"If opportunity doesnâ€™t knock, build a door.",vi:"Náº¿u cÆ¡ há»™i khÃ´ng gÃµ cá»­a, hÃ£y xÃ¢y má»™t cÃ¡nh cá»­a.",author:"Milton Berle"},
Â  Â  {en:"Everything you can imagine is real.",vi:"Má»i thá»© báº¡n tÆ°á»Ÿng tÆ°á»£ng Ä‘á»u cÃ³ thá»ƒ trá»Ÿ thÃ nh hiá»‡n thá»±c.",author:"Pablo Picasso"},
Â  Â  {en:"Action is the foundational key to all success.",vi:"HÃ nh Ä‘á»™ng lÃ  chÃ¬a khÃ³a ná»n táº£ng cá»§a má»i thÃ nh cÃ´ng.",author:"Pablo Picasso"},
Â  Â  {en:"Turn your wounds into wisdom.",vi:"Biáº¿n váº¿t thÆ°Æ¡ng thÃ nh trÃ­ tuá»‡.",author:"Oprah Winfrey"},
Â  Â  {en:"The biggest adventure you can take is to live the life of your dreams.",vi:"Cuá»™c phiÃªu lÆ°u lá»›n nháº¥t lÃ  sá»‘ng cuá»™c Ä‘á»i mÆ¡ Æ°á»›c.",author:"Oprah Winfrey"},
Â  Â  {en:"Donâ€™t let yesterday take up too much of today.",vi:"Äá»«ng Ä‘á»ƒ ngÃ y hÃ´m qua chiáº¿m quÃ¡ nhiá»u cá»§a hÃ´m nay.",author:"Will Rogers"},
Â  Â  {en:"A journey of a thousand miles begins with a single step.",vi:"HÃ nh trÃ¬nh ngÃ n dáº·m báº¯t Ä‘áº§u tá»« má»™t bÆ°á»›c chÃ¢n.",author:"Lao Tzu"},
Â  Â  {en:"When you let go, you create space for something better.",vi:"BuÃ´ng bá» táº¡o chá»— cho Ä‘iá»u tá»‘t Ä‘áº¹p hÆ¡n.",author:"Unknown"},
Â  Â  {en:"Small steps every day lead to big results.",vi:"Nhá»¯ng bÆ°á»›c nhá» má»—i ngÃ y táº¡o nÃªn káº¿t quáº£ lá»›n.",author:"Unknown"},
Â  Â  {en:"Discipline is the bridge between goals and accomplishment.",vi:"Ká»· luáº­t lÃ  cÃ¢y cáº§u ná»‘i má»¥c tiÃªu vá»›i thÃ nh tá»±u.",author:"Jim Rohn"},
Â  Â  {en:"Motivation gets you started. Habit keeps you going.",vi:"Äá»™ng lá»±c giÃºp báº¡n báº¯t Ä‘áº§u, thÃ³i quen giÃºp báº¡n tiáº¿p tá»¥c.",author:"Jim Rohn"},
Â  Â  {en:"The harder you work, the luckier you get.",vi:"Báº¡n cÃ ng ná»— lá»±c, báº¡n cÃ ng may máº¯n.",author:"Gary Player"},
Â  Â  {en:"Do something today that your future self will thank you for.",vi:"HÃ£y lÃ m hÃ´m nay Ä‘iá»u mÃ  tÆ°Æ¡ng lai sáº½ cáº£m Æ¡n báº¡n.",author:"Unknown"},
Â  Â  {en:"Success is a journey, not a destination.",vi:"ThÃ nh cÃ´ng lÃ  hÃ nh trÃ¬nh, khÃ´ng pháº£i Ä‘Ã­ch Ä‘áº¿n.",author:"Ben Sweetland"},
Â  Â  {en:"Donâ€™t be afraid to give up the good to go for the great.",vi:"Äá»«ng sá»£ tá»« bá» cÃ¡i tá»‘t Ä‘á»ƒ Ä‘áº¡t tá»›i cÃ¡i vÄ© Ä‘áº¡i.",author:"John D. Rockefeller"},
Â  Â  {en:"The purpose of our lives is to be happy.",vi:"Má»¥c Ä‘Ã­ch cá»§a cuá»™c sá»‘ng lÃ  háº¡nh phÃºc.",author:"Dalai Lama"},
Â  Â  {en:"Happiness is not something ready-made.",vi:"Háº¡nh phÃºc khÃ´ng pháº£i tá»± nhiÃªn mÃ  cÃ³.",author:"Dalai Lama"},
Â  Â  {en:"Live as if you were to die tomorrow. Learn as if you were to live forever.",vi:"Sá»‘ng nhÆ° thá»ƒ báº¡n sáº½ cháº¿t ngÃ y mai, há»c nhÆ° thá»ƒ sá»‘ng mÃ£i.",author:"Mahatma Gandhi"},
Â  Â  {en:"Do not go where the path may lead, go instead where there is no path.",vi:"Äá»«ng Ä‘i theo lá»‘i mÃ²n, hÃ£y táº¡o lá»‘i Ä‘i riÃªng.",author:"Ralph Waldo Emerson"},
Â  Â  {en:"What we think, we become.",vi:"ChÃºng ta nghÄ© gÃ¬, chÃºng ta trá»Ÿ thÃ nh nhÆ° váº­y.",author:"Buddha"},
Â  Â  {en:"Peace comes from within. Do not seek it without.",vi:"BÃ¬nh an Ä‘áº¿n tá»« bÃªn trong, Ä‘á»«ng tÃ¬m bÃªn ngoÃ i.",author:"Buddha"},
Â  Â  {en:"Quality is not an act, it is a habit.",vi:"Cháº¥t lÆ°á»£ng khÃ´ng pháº£i lÃ  hÃ nh Ä‘á»™ng, mÃ  lÃ  thÃ³i quen.",author:"Aristotle"},
Â  Â  {en:"Do what is right, not what is easy.",vi:"HÃ£y lÃ m Ä‘iá»u Ä‘Ãºng, khÃ´ng pháº£i Ä‘iá»u dá»….",author:"Unknown"},
Â  Â  {en:"Be yourself; everyone else is already taken.",vi:"HÃ£y lÃ  chÃ­nh mÃ¬nh, má»i ngÆ°á»i khÃ¡c Ä‘Ã£ cÃ³ rá»“i.",author:"Oscar Wilde"},
Â  Â  {en:"To live is the rarest thing in the world.",vi:"Sá»‘ng tháº­t sá»± lÃ  Ä‘iá»u hiáº¿m nháº¥t.",author:"Oscar Wilde"},
Â  Â  {en:"If you can dream it, you can do it.",vi:"Náº¿u báº¡n mÆ¡ Ä‘Æ°á»£c, báº¡n lÃ m Ä‘Æ°á»£c.",author:"Walt Disney"},
Â  Â  {en:"All our dreams can come true, if we have the courage to pursue them.",vi:"Má»i Æ°á»›c mÆ¡ Ä‘á»u cÃ³ thá»ƒ thÃ nh hiá»‡n thá»±c náº¿u ta Ä‘á»§ can Ä‘áº£m.",author:"Walt Disney"},
Â  Â  {en:"Success is liking yourself.",vi:"ThÃ nh cÃ´ng lÃ  yÃªu chÃ­nh mÃ¬nh.",author:"Maya Angelou"},
Â  Â  {en:"Try to be a rainbow in someoneâ€™s cloud.",vi:"HÃ£y lÃ  cáº§u vá»“ng trong mÃ¢y mÃ¹ cá»§a ai Ä‘Ã³.",author:"Maya Angelou"},
Â  Â  {en:"The only limit is your mind.",vi:"Giá»›i háº¡n duy nháº¥t lÃ  tÃ¢m trÃ­ báº¡n.",author:"Unknown"},
Â  Â  {en:"Your life does not get better by chance, it gets better by change.",vi:"Cuá»™c sá»‘ng tá»‘t hÆ¡n nhá» thay Ä‘á»•i, khÃ´ng pháº£i may máº¯n.",author:"Jim Rohn"},
Â  Â  {en:"Donâ€™t wish it were easier. Wish you were better.",vi:"Äá»«ng mong dá»… hÆ¡n, hÃ£y mong mÃ¬nh giá»i hÆ¡n.",author:"Jim Rohn"},
Â  Â  {en:"Nothing will work unless you do.",vi:"KhÃ´ng gÃ¬ hiá»‡u quáº£ náº¿u báº¡n khÃ´ng lÃ m.",author:"Maya Angelou"},
Â  Â  {en:"Believe in yourself.",vi:"HÃ£y tin vÃ o chÃ­nh mÃ¬nh.",author:"Unknown"},
Â  Â  {en:"One day or day one. You decide.",vi:"Má»™t ngÃ y nÃ o Ä‘Ã³ hay lÃ  ngÃ y Ä‘áº§u tiÃªn â€“ báº¡n quyáº¿t Ä‘á»‹nh.",author:"Unknown"},
Â  Â  {en:"Great things never come from comfort zones.",vi:"Äiá»u vÄ© Ä‘áº¡i khÃ´ng Ä‘áº¿n tá»« vÃ¹ng an toÃ n.",author:"Unknown"},
Â  Â  {en:"Focus on progress, not perfection.",vi:"Táº­p trung vÃ o tiáº¿n bá»™, khÃ´ng pháº£i sá»± hoÃ n háº£o.",author:"Unknown"},
Â  Â  {en:"Your only limit is you.",vi:"Giá»›i háº¡n duy nháº¥t lÃ  chÃ­nh báº¡n.",author:"Unknown"},
Â  Â  {en:"Make today count.",vi:"HÃ£y lÃ m hÃ´m nay trá»Ÿ nÃªn Ä‘Ã¡ng giÃ¡.",author:"Unknown"}
Â  ];
Â  /* =========================
Â  Â  Â 2) ENGINE
Â  Â  Â ========================= */
Â  function randomQuote(){
Â  Â  return QUOTES[Math.floor(Math.random()*QUOTES.length)];
Â  }
Â  function dailyQuote(){
Â  Â  const day = Math.floor(Date.now()/86400000);
Â  Â  return QUOTES[day % QUOTES.length];
Â  }
Â  /* =========================
Â  Â  Â 3) EXPOSE FOR APP
Â  Â  Â ========================= */
Â  window.MV_QUOTES = {
Â  Â  list: QUOTES,
Â  Â  random: randomQuote,
Â  Â  daily: dailyQuote
Â  };
Â  toast("âœ… PART 10 updated: 100 Great Quotes loaded");
})();

sao nháº­p code k lÃªn 
